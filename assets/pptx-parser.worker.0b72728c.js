var At=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Gt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,e){(function(t){i.exports=t()})(function(){return function t(h,a,r){function l(m,b){if(!a[m]){if(!h[m]){var y=typeof Tt=="function"&&Tt;if(!b&&y)return y(m,!0);if(s)return s(m,!0);var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var c=a[m]={exports:{}};h[m][0].call(c.exports,function(w){var f=h[m][1][w];return l(f||w)},c,c.exports,t,h,a,r)}return a[m].exports}for(var s=typeof Tt=="function"&&Tt,o=0;o<r.length;o++)l(r[o]);return l}({1:[function(t,h,a){var r=t("./utils"),l=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(o){for(var m,b,y,k,c,w,f,g=[],d=0,v=o.length,x=v,I=r.getTypeOf(o)!=="string";d<o.length;)x=v-d,y=I?(m=o[d++],b=d<v?o[d++]:0,d<v?o[d++]:0):(m=o.charCodeAt(d++),b=d<v?o.charCodeAt(d++):0,d<v?o.charCodeAt(d++):0),k=m>>2,c=(3&m)<<4|b>>4,w=1<x?(15&b)<<2|y>>6:64,f=2<x?63&y:64,g.push(s.charAt(k)+s.charAt(c)+s.charAt(w)+s.charAt(f));return g.join("")},a.decode=function(o){var m,b,y,k,c,w,f=0,g=0,d="data:";if(o.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var v,x=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===s.charAt(64)&&x--,o.charAt(o.length-2)===s.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=l.uint8array?new Uint8Array(0|x):new Array(0|x);f<o.length;)m=s.indexOf(o.charAt(f++))<<2|(k=s.indexOf(o.charAt(f++)))>>4,b=(15&k)<<4|(c=s.indexOf(o.charAt(f++)))>>2,y=(3&c)<<6|(w=s.indexOf(o.charAt(f++))),v[g++]=m,c!==64&&(v[g++]=b),w!==64&&(v[g++]=y);return v}},{"./support":30,"./utils":32}],2:[function(t,h,a){var r=t("./external"),l=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function m(b,y,k,c,w){this.compressedSize=b,this.uncompressedSize=y,this.crc32=k,this.compression=c,this.compressedContent=w}m.prototype={getContentWorker:function(){var b=new l(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),y=this;return b.on("end",function(){if(this.streamInfo.data_length!==y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new l(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(b,y,k){return b.pipe(new s).pipe(new o("uncompressedSize")).pipe(y.compressWorker(k)).pipe(new o("compressedSize")).withStreamInfo("compression",y)},h.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,h,a){var r=t("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},a.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,h,a){var r=t("./utils"),l=function(){for(var s,o=[],m=0;m<256;m++){s=m;for(var b=0;b<8;b++)s=1&s?3988292384^s>>>1:s>>>1;o[m]=s}return o}();h.exports=function(s,o){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(m,b,y,k){var c=l,w=k+y;m^=-1;for(var f=k;f<w;f++)m=m>>>8^c[255&(m^b[f])];return-1^m}(0|o,s,s.length,0):function(m,b,y,k){var c=l,w=k+y;m^=-1;for(var f=k;f<w;f++)m=m>>>8^c[255&(m^b.charCodeAt(f))];return-1^m}(0|o,s,s.length,0):0}},{"./utils":32}],5:[function(t,h,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(t,h,a){var r=null;r=typeof Promise<"u"?Promise:t("lie"),h.exports={Promise:r}},{lie:37}],7:[function(t,h,a){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=t("pako"),s=t("./utils"),o=t("./stream/GenericWorker"),m=r?"uint8array":"array";function b(y,k){o.call(this,"FlateWorker/"+y),this._pako=null,this._pakoAction=y,this._pakoOptions=k,this.meta={}}a.magic="\b\0",s.inherits(b,o),b.prototype.processChunk=function(y){this.meta=y.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(m,y.data),!1)},b.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var y=this;this._pako.onData=function(k){y.push({data:k,meta:y.meta})}},a.compressWorker=function(y){return new b("Deflate",y)},a.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,h,a){function r(c,w){var f,g="";for(f=0;f<w;f++)g+=String.fromCharCode(255&c),c>>>=8;return g}function l(c,w,f,g,d,v){var x,I,C=c.file,L=c.compression,P=v!==m.utf8encode,Z=s.transformTo("string",v(C.name)),O=s.transformTo("string",m.utf8encode(C.name)),G=C.comment,J=s.transformTo("string",v(G)),E=s.transformTo("string",m.utf8encode(G)),F=O.length!==C.name.length,u=E.length!==G.length,R="",Q="",M="",tt=C.dir,W=C.date,D={crc32:0,compressedSize:0,uncompressedSize:0};w&&!f||(D.crc32=c.crc32,D.compressedSize=c.compressedSize,D.uncompressedSize=c.uncompressedSize);var z=0;w&&(z|=8),P||!F&&!u||(z|=2048);var T=0,q=0;tt&&(T|=16),d==="UNIX"?(q=798,T|=function(H,st){var ht=H;return H||(ht=st?16893:33204),(65535&ht)<<16}(C.unixPermissions,tt)):(q=20,T|=function(H){return 63&(H||0)}(C.dosPermissions)),x=W.getUTCHours(),x<<=6,x|=W.getUTCMinutes(),x<<=5,x|=W.getUTCSeconds()/2,I=W.getUTCFullYear()-1980,I<<=4,I|=W.getUTCMonth()+1,I<<=5,I|=W.getUTCDate(),F&&(Q=r(1,1)+r(b(Z),4)+O,R+="up"+r(Q.length,2)+Q),u&&(M=r(1,1)+r(b(J),4)+E,R+="uc"+r(M.length,2)+M);var X="";return X+=`
\0`,X+=r(z,2),X+=L.magic,X+=r(x,2),X+=r(I,2),X+=r(D.crc32,4),X+=r(D.compressedSize,4),X+=r(D.uncompressedSize,4),X+=r(Z.length,2),X+=r(R.length,2),{fileRecord:y.LOCAL_FILE_HEADER+X+Z+R,dirRecord:y.CENTRAL_FILE_HEADER+r(q,2)+X+r(J.length,2)+"\0\0\0\0"+r(T,4)+r(g,4)+Z+R+J}}var s=t("../utils"),o=t("../stream/GenericWorker"),m=t("../utf8"),b=t("../crc32"),y=t("../signature");function k(c,w,f,g){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=f,this.encodeFileName=g,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(k,o),k.prototype.push=function(c){var w=c.meta.percent||0,f=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,o.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:f?(w+100*(f-g-1))/f:100}}))},k.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var w=this.streamFiles&&!c.file.dir;if(w){var f=l(c,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},k.prototype.closedSource=function(c){this.accumulate=!1;var w=this.streamFiles&&!c.file.dir,f=l(c,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),w)this.push({data:function(g){return y.DATA_DESCRIPTOR+r(g.crc32,4)+r(g.compressedSize,4)+r(g.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},k.prototype.flush=function(){for(var c=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var f=this.bytesWritten-c,g=function(d,v,x,I,C){var L=s.transformTo("string",C(I));return y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(d,2)+r(d,2)+r(v,4)+r(x,4)+r(L.length,2)+L}(this.dirRecords.length,f,c,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},k.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},k.prototype.registerPrevious=function(c){this._sources.push(c);var w=this;return c.on("data",function(f){w.processChunk(f)}),c.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),c.on("error",function(f){w.error(f)}),this},k.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},k.prototype.error=function(c){var w=this._sources;if(!o.prototype.error.call(this,c))return!1;for(var f=0;f<w.length;f++)try{w[f].error(c)}catch{}return!0},k.prototype.lock=function(){o.prototype.lock.call(this);for(var c=this._sources,w=0;w<c.length;w++)c[w].lock()},h.exports=k},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,h,a){var r=t("../compressions"),l=t("./ZipFileWorker");a.generateWorker=function(s,o,m){var b=new l(o.streamFiles,m,o.platform,o.encodeFileName),y=0;try{s.forEach(function(k,c){y++;var w=function(v,x){var I=v||x,C=r[I];if(!C)throw new Error(I+" is not a valid compression method !");return C}(c.options.compression,o.compression),f=c.options.compressionOptions||o.compressionOptions||{},g=c.dir,d=c.date;c._compressWorker(w,f).withStreamInfo("file",{name:k,dir:g,date:d,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(b)}),b.entriesCount=y}catch(k){b.error(k)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,h,a){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new r;for(var s in this)typeof this[s]!="function"&&(l[s]=this[s]);return l}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(l,s){return new r().loadAsync(l,s)},r.external=t("./external"),h.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,h,a){var r=t("./utils"),l=t("./external"),s=t("./utf8"),o=t("./zipEntries"),m=t("./stream/Crc32Probe"),b=t("./nodejsUtils");function y(k){return new l.Promise(function(c,w){var f=k.decompressed.getContentWorker().pipe(new m);f.on("error",function(g){w(g)}).on("end",function(){f.streamInfo.crc32!==k.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}h.exports=function(k,c){var w=this;return c=r.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),b.isNode&&b.isStream(k)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",k,!0,c.optimizedBinaryString,c.base64).then(function(f){var g=new o(c);return g.load(f),g}).then(function(f){var g=[l.Promise.resolve(f)],d=f.files;if(c.checkCRC32)for(var v=0;v<d.length;v++)g.push(y(d[v]));return l.Promise.all(g)}).then(function(f){for(var g=f.shift(),d=g.files,v=0;v<d.length;v++){var x=d[v],I=x.fileNameStr,C=r.resolve(x.fileNameStr);w.file(C,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:c.createFolders}),x.dir||(w.file(C).unsafeOriginalName=I)}return g.zipComment.length&&(w.comment=g.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,h,a){var r=t("../utils"),l=t("../stream/GenericWorker");function s(o,m){l.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(m)}r.inherits(s,l),s.prototype._bindStream=function(o){var m=this;(this._stream=o).pause(),o.on("data",function(b){m.push({data:b,meta:{percent:0}})}).on("error",function(b){m.isPaused?this.generatedError=b:m.error(b)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},s.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},h.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,h,a){var r=t("readable-stream").Readable;function l(s,o,m){r.call(this,o),this._helper=s;var b=this;s.on("data",function(y,k){b.push(y)||b._helper.pause(),m&&m(k)}).on("error",function(y){b.emit("error",y)}).on("end",function(){b.push(null)})}t("../utils").inherits(l,r),l.prototype._read=function(){this._helper.resume()},h.exports=l},{"../utils":32,"readable-stream":16}],14:[function(t,h,a){h.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,l);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,l)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var l=new Buffer(r);return l.fill(0),l},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,h,a){function r(C,L,P){var Z,O=s.getTypeOf(L),G=s.extend(P||{},b);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(C=d(C)),G.createFolders&&(Z=g(C))&&v.call(this,Z,!0);var J=O==="string"&&G.binary===!1&&G.base64===!1;P&&P.binary!==void 0||(G.binary=!J),(L instanceof y&&L.uncompressedSize===0||G.dir||!L||L.length===0)&&(G.base64=!1,G.binary=!0,L="",G.compression="STORE",O="string");var E=null;E=L instanceof y||L instanceof o?L:w.isNode&&w.isStream(L)?new f(C,L):s.prepareContent(C,L,G.binary,G.optimizedBinaryString,G.base64);var F=new k(C,E,G);this.files[C]=F}var l=t("./utf8"),s=t("./utils"),o=t("./stream/GenericWorker"),m=t("./stream/StreamHelper"),b=t("./defaults"),y=t("./compressedObject"),k=t("./zipObject"),c=t("./generate"),w=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),g=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var L=C.lastIndexOf("/");return 0<L?C.substring(0,L):""},d=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},v=function(C,L){return L=L!==void 0?L:b.createFolders,C=d(C),this.files[C]||r.call(this,C,null,{dir:!0,createFolders:L}),this.files[C]};function x(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var L,P,Z;for(L in this.files)Z=this.files[L],(P=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&C(P,Z)},filter:function(C){var L=[];return this.forEach(function(P,Z){C(P,Z)&&L.push(Z)}),L},file:function(C,L,P){if(arguments.length!==1)return C=this.root+C,r.call(this,C,L,P),this;if(x(C)){var Z=C;return this.filter(function(G,J){return!J.dir&&Z.test(G)})}var O=this.files[this.root+C];return O&&!O.dir?O:null},folder:function(C){if(!C)return this;if(x(C))return this.filter(function(O,G){return G.dir&&C.test(O)});var L=this.root+C,P=v.call(this,L),Z=this.clone();return Z.root=P.name,Z},remove:function(C){C=this.root+C;var L=this.files[C];if(L||(C.slice(-1)!=="/"&&(C+="/"),L=this.files[C]),L&&!L.dir)delete this.files[C];else for(var P=this.filter(function(O,G){return G.name.slice(0,C.length)===C}),Z=0;Z<P.length;Z++)delete this.files[P[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var L,P={};try{if((P=s.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");s.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var Z=P.comment||this.comment||"";L=c.generateWorker(this,P,Z)}catch(O){(L=new o("error")).error(O)}return new m(L,P.type||"string",P.mimeType)},generateAsync:function(C,L){return this.generateInternalStream(C).accumulate(L)},generateNodeStream:function(C,L){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(L)}};h.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,h,a){h.exports=t("stream")},{stream:void 0}],17:[function(t,h,a){var r=t("./DataReader");function l(s){r.call(this,s);for(var o=0;o<this.data.length;o++)s[o]=255&s[o]}t("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data[this.zero+s]},l.prototype.lastIndexOfSignature=function(s){for(var o=s.charCodeAt(0),m=s.charCodeAt(1),b=s.charCodeAt(2),y=s.charCodeAt(3),k=this.length-4;0<=k;--k)if(this.data[k]===o&&this.data[k+1]===m&&this.data[k+2]===b&&this.data[k+3]===y)return k-this.zero;return-1},l.prototype.readAndCheckSignature=function(s){var o=s.charCodeAt(0),m=s.charCodeAt(1),b=s.charCodeAt(2),y=s.charCodeAt(3),k=this.readData(4);return o===k[0]&&m===k[1]&&b===k[2]&&y===k[3]},l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},h.exports=l},{"../utils":32,"./DataReader":18}],18:[function(t,h,a){var r=t("../utils");function l(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var o,m=0;for(this.checkOffset(s),o=this.index+s-1;o>=this.index;o--)m=(m<<8)+this.byteAt(o);return this.index+=s,m},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},h.exports=l},{"../utils":32}],19:[function(t,h,a){var r=t("./Uint8ArrayReader");function l(s){r.call(this,s)}t("../utils").inherits(l,r),l.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},h.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,h,a){var r=t("./DataReader");function l(s){r.call(this,s)}t("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},l.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},l.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},l.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},h.exports=l},{"../utils":32,"./DataReader":18}],21:[function(t,h,a){var r=t("./ArrayReader");function l(s){r.call(this,s)}t("../utils").inherits(l,r),l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},h.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(t,h,a){var r=t("../utils"),l=t("../support"),s=t("./ArrayReader"),o=t("./StringReader"),m=t("./NodeBufferReader"),b=t("./Uint8ArrayReader");h.exports=function(y){var k=r.getTypeOf(y);return r.checkSupport(k),k!=="string"||l.uint8array?k==="nodebuffer"?new m(y):l.uint8array?new b(r.transformTo("uint8array",y)):new s(r.transformTo("array",y)):new o(y)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,h,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,h,a){var r=t("./GenericWorker"),l=t("../utils");function s(o){r.call(this,"ConvertWorker to "+o),this.destType=o}l.inherits(s,r),s.prototype.processChunk=function(o){this.push({data:l.transformTo(this.destType,o.data),meta:o.meta})},h.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,h,a){var r=t("./GenericWorker"),l=t("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,r),s.prototype.processChunk=function(o){this.streamInfo.crc32=l(o.data,this.streamInfo.crc32||0),this.push(o)},h.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,h,a){var r=t("../utils"),l=t("./GenericWorker");function s(o){l.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}r.inherits(s,l),s.prototype.processChunk=function(o){if(o){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+o.data.length}l.prototype.processChunk.call(this,o)},h.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,h,a){var r=t("../utils"),l=t("./GenericWorker");function s(o){l.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(b){m.dataIsReady=!0,m.data=b,m.max=b&&b.length||0,m.type=r.getTypeOf(b),m.isPaused||m._tickAndRepeat()},function(b){m.error(b)})}r.inherits(s,l),s.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,m);break;case"uint8array":o=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":o=this.data.slice(this.index,m)}return this.index=m,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},h.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,h,a){function r(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,s){return this._listeners[l].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,s){if(this._listeners[l])for(var o=0;o<this._listeners[l].length;o++)this._listeners[l][o].call(this,s)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var s=this;return l.on("data",function(o){s.processChunk(o)}),l.on("end",function(){s.end()}),l.on("error",function(o){s.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,s){return this.extraStreamInfo[l]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},h.exports=r},{}],29:[function(t,h,a){var r=t("../utils"),l=t("./ConvertWorker"),s=t("./GenericWorker"),o=t("../base64"),m=t("../support"),b=t("../external"),y=null;if(m.nodestream)try{y=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function k(w,f){return new b.Promise(function(g,d){var v=[],x=w._internalType,I=w._outputType,C=w._mimeType;w.on("data",function(L,P){v.push(L),f&&f(P)}).on("error",function(L){v=[],d(L)}).on("end",function(){try{var L=function(P,Z,O){switch(P){case"blob":return r.newBlob(r.transformTo("arraybuffer",Z),O);case"base64":return o.encode(Z);default:return r.transformTo(P,Z)}}(I,function(P,Z){var O,G=0,J=null,E=0;for(O=0;O<Z.length;O++)E+=Z[O].length;switch(P){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(J=new Uint8Array(E),O=0;O<Z.length;O++)J.set(Z[O],G),G+=Z[O].length;return J;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+P+"'")}}(x,v),C);g(L)}catch(P){d(P)}v=[]}).resume()})}function c(w,f,g){var d=f;switch(f){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=f,this._mimeType=g,r.checkSupport(d),this._worker=w.pipe(new l(d)),w.lock()}catch(v){this._worker=new s("error"),this._worker.error(v)}}c.prototype={accumulate:function(w){return k(this,w)},on:function(w,f){var g=this;return w==="data"?this._worker.on(w,function(d){f.call(g,d.data,d.meta)}):this._worker.on(w,function(){r.delay(f,arguments,g)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new y(this,{objectMode:this._outputType!=="nodebuffer"},w)}},h.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,h,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var r=new ArrayBuffer(0);try{a.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(r),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!t("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(t,h,a){for(var r=t("./utils"),l=t("./support"),s=t("./nodejsUtils"),o=t("./stream/GenericWorker"),m=new Array(256),b=0;b<256;b++)m[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;m[254]=m[254]=1;function y(){o.call(this,"utf-8 decode"),this.leftOver=null}function k(){o.call(this,"utf-8 encode")}a.utf8encode=function(c){return l.nodebuffer?s.newBufferFrom(c,"utf-8"):function(w){var f,g,d,v,x,I=w.length,C=0;for(v=0;v<I;v++)(64512&(g=w.charCodeAt(v)))==55296&&v+1<I&&(64512&(d=w.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(d-56320),v++),C+=g<128?1:g<2048?2:g<65536?3:4;for(f=l.uint8array?new Uint8Array(C):new Array(C),v=x=0;x<C;v++)(64512&(g=w.charCodeAt(v)))==55296&&v+1<I&&(64512&(d=w.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(d-56320),v++),g<128?f[x++]=g:(g<2048?f[x++]=192|g>>>6:(g<65536?f[x++]=224|g>>>12:(f[x++]=240|g>>>18,f[x++]=128|g>>>12&63),f[x++]=128|g>>>6&63),f[x++]=128|63&g);return f}(c)},a.utf8decode=function(c){return l.nodebuffer?r.transformTo("nodebuffer",c).toString("utf-8"):function(w){var f,g,d,v,x=w.length,I=new Array(2*x);for(f=g=0;f<x;)if((d=w[f++])<128)I[g++]=d;else if(4<(v=m[d]))I[g++]=65533,f+=v-1;else{for(d&=v===2?31:v===3?15:7;1<v&&f<x;)d=d<<6|63&w[f++],v--;1<v?I[g++]=65533:d<65536?I[g++]=d:(d-=65536,I[g++]=55296|d>>10&1023,I[g++]=56320|1023&d)}return I.length!==g&&(I.subarray?I=I.subarray(0,g):I.length=g),r.applyFromCharCode(I)}(c=r.transformTo(l.uint8array?"uint8array":"array",c))},r.inherits(y,o),y.prototype.processChunk=function(c){var w=r.transformTo(l.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var f=w;(w=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),w.set(f,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var g=function(v,x){var I;for((x=x||v.length)>v.length&&(x=v.length),I=x-1;0<=I&&(192&v[I])==128;)I--;return I<0||I===0?x:I+m[v[I]]>x?I:x}(w),d=w;g!==w.length&&(l.uint8array?(d=w.subarray(0,g),this.leftOver=w.subarray(g,w.length)):(d=w.slice(0,g),this.leftOver=w.slice(g,w.length))),this.push({data:a.utf8decode(d),meta:c.meta})},y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=y,r.inherits(k,o),k.prototype.processChunk=function(c){this.push({data:a.utf8encode(c.data),meta:c.meta})},a.Utf8EncodeWorker=k},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,h,a){var r=t("./support"),l=t("./base64"),s=t("./nodejsUtils"),o=t("./external");function m(f){return f}function b(f,g){for(var d=0;d<f.length;++d)g[d]=255&f.charCodeAt(d);return g}t("setimmediate"),a.newBlob=function(f,g){a.checkSupport("blob");try{return new Blob([f],{type:g})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(f),d.getBlob(g)}catch{throw new Error("Bug : can't construct the Blob.")}}};var y={stringifyByChunk:function(f,g,d){var v=[],x=0,I=f.length;if(I<=d)return String.fromCharCode.apply(null,f);for(;x<I;)g==="array"||g==="nodebuffer"?v.push(String.fromCharCode.apply(null,f.slice(x,Math.min(x+d,I)))):v.push(String.fromCharCode.apply(null,f.subarray(x,Math.min(x+d,I)))),x+=d;return v.join("")},stringifyByChar:function(f){for(var g="",d=0;d<f.length;d++)g+=String.fromCharCode(f[d]);return g},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function k(f){var g=65536,d=a.getTypeOf(f),v=!0;if(d==="uint8array"?v=y.applyCanBeUsed.uint8array:d==="nodebuffer"&&(v=y.applyCanBeUsed.nodebuffer),v)for(;1<g;)try{return y.stringifyByChunk(f,d,g)}catch{g=Math.floor(g/2)}return y.stringifyByChar(f)}function c(f,g){for(var d=0;d<f.length;d++)g[d]=f[d];return g}a.applyFromCharCode=k;var w={};w.string={string:m,array:function(f){return b(f,new Array(f.length))},arraybuffer:function(f){return w.string.uint8array(f).buffer},uint8array:function(f){return b(f,new Uint8Array(f.length))},nodebuffer:function(f){return b(f,s.allocBuffer(f.length))}},w.array={string:k,array:m,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(f)}},w.arraybuffer={string:function(f){return k(new Uint8Array(f))},array:function(f){return c(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:m,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return s.newBufferFrom(new Uint8Array(f))}},w.uint8array={string:k,array:function(f){return c(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:m,nodebuffer:function(f){return s.newBufferFrom(f)}},w.nodebuffer={string:k,array:function(f){return c(f,new Array(f.length))},arraybuffer:function(f){return w.nodebuffer.uint8array(f).buffer},uint8array:function(f){return c(f,new Uint8Array(f.length))},nodebuffer:m},a.transformTo=function(f,g){if(g=g||"",!f)return g;a.checkSupport(f);var d=a.getTypeOf(g);return w[d][f](g)},a.resolve=function(f){for(var g=f.split("/"),d=[],v=0;v<g.length;v++){var x=g[v];x==="."||x===""&&v!==0&&v!==g.length-1||(x===".."?d.pop():d.push(x))}return d.join("/")},a.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(f)?"nodebuffer":r.uint8array&&f instanceof Uint8Array?"uint8array":r.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(f){if(!r[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(f){var g,d,v="";for(d=0;d<(f||"").length;d++)v+="\\x"+((g=f.charCodeAt(d))<16?"0":"")+g.toString(16).toUpperCase();return v},a.delay=function(f,g,d){setImmediate(function(){f.apply(d||null,g||[])})},a.inherits=function(f,g){function d(){}d.prototype=g.prototype,f.prototype=new d},a.extend=function(){var f,g,d={};for(f=0;f<arguments.length;f++)for(g in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],g)&&d[g]===void 0&&(d[g]=arguments[f][g]);return d},a.prepareContent=function(f,g,d,v,x){return o.Promise.resolve(g).then(function(I){return r.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new o.Promise(function(C,L){var P=new FileReader;P.onload=function(Z){C(Z.target.result)},P.onerror=function(Z){L(Z.target.error)},P.readAsArrayBuffer(I)}):I}).then(function(I){var C=a.getTypeOf(I);return C?(C==="arraybuffer"?I=a.transformTo("uint8array",I):C==="string"&&(x?I=l.decode(I):d&&v!==!0&&(I=function(L){return b(L,r.uint8array?new Uint8Array(L.length):new Array(L.length))}(I))),I):o.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,h,a){var r=t("./reader/readerFor"),l=t("./utils"),s=t("./signature"),o=t("./zipEntry"),m=t("./support");function b(y){this.files=[],this.loadOptions=y}b.prototype={checkSignature:function(y){if(!this.reader.readAndCheckSignature(y)){this.reader.index-=4;var k=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(k)+", expected "+l.pretty(y)+")")}},isSignature:function(y,k){var c=this.reader.index;this.reader.setIndex(y);var w=this.reader.readString(4)===k;return this.reader.setIndex(c),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var y=this.reader.readData(this.zipCommentLength),k=m.uint8array?"uint8array":"array",c=l.transformTo(k,y);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var y,k,c,w=this.zip64EndOfCentralSize-44;0<w;)y=this.reader.readInt(2),k=this.reader.readInt(4),c=this.reader.readData(k),this.zip64ExtensibleData[y]={id:y,length:k,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var y,k;for(y=0;y<this.files.length;y++)k=this.files[y],this.reader.setIndex(k.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),k.readLocalPart(this.reader),k.handleUTF8(),k.processAttributes()},readCentralDir:function(){var y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(y=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(y);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var y=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(y<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(y);var k=y;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(y=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(y),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var w=k-c;if(0<w)this.isSignature(k,s.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(y){this.reader=r(y)},load:function(y){this.prepareReader(y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},h.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,h,a){var r=t("./reader/readerFor"),l=t("./utils"),s=t("./compressedObject"),o=t("./crc32"),m=t("./utf8"),b=t("./compressions"),y=t("./support");function k(c,w){this.options=c,this.loadOptions=w}k.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var w,f;if(c.skip(22),this.fileNameLength=c.readInt(2),f=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(g){for(var d in b)if(Object.prototype.hasOwnProperty.call(b,d)&&b[d].magic===g)return b[d];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,w,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var w=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(w),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=r(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var w,f,g,d=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<d;)w=c.readInt(2),f=c.readInt(2),g=c.readData(f),this.extraFields[w]={id:w,length:f,value:g};c.setIndex(d)},handleUTF8:function(){var c=y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var f=l.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var d=l.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var w=r(c.value);return w.readInt(1)!==1||o(this.fileName)!==w.readInt(4)?null:m.utf8decode(w.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var w=r(c.value);return w.readInt(1)!==1||o(this.fileComment)!==w.readInt(4)?null:m.utf8decode(w.readData(c.length-5))}return null}},h.exports=k},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,h,a){function r(w,f,g){this.name=w,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=f,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var l=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),o=t("./utf8"),m=t("./compressedObject"),b=t("./stream/GenericWorker");r.prototype={internalStream:function(w){var f=null,g="string";try{if(!w)throw new Error("No output type specified.");var d=(g=w.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),f=this._decompressWorker();var v=!this._dataBinary;v&&!d&&(f=f.pipe(new o.Utf8EncodeWorker)),!v&&d&&(f=f.pipe(new o.Utf8DecodeWorker))}catch(x){(f=new b("error")).error(x)}return new l(f,g,"")},async:function(w,f){return this.internalStream(w).accumulate(f)},nodeStream:function(w,f){return this.internalStream(w||"nodebuffer").toNodejsStream(f)},_compressWorker:function(w,f){if(this._data instanceof m&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new o.Utf8EncodeWorker)),m.createWorkerFrom(g,w,f)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof b?this._data:new s(this._data)}};for(var y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],k=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<y.length;c++)r.prototype[y[c]]=k;h.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,h,a){(function(r){var l,s,o=r.MutationObserver||r.WebKitMutationObserver;if(o){var m=0,b=new o(w),y=r.document.createTextNode("");b.observe(y,{characterData:!0}),l=function(){y.data=m=++m%2}}else if(r.setImmediate||r.MessageChannel===void 0)l="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var f=r.document.createElement("script");f.onreadystatechange=function(){w(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},r.document.documentElement.appendChild(f)}:function(){setTimeout(w,0)};else{var k=new r.MessageChannel;k.port1.onmessage=w,l=function(){k.port2.postMessage(0)}}var c=[];function w(){var f,g;s=!0;for(var d=c.length;d;){for(g=c,c=[],f=-1;++f<d;)g[f]();d=c.length}s=!1}h.exports=function(f){c.push(f)!==1||s||l()}}).call(this,typeof At<"u"?At:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,h,a){var r=t("immediate");function l(){}var s={},o=["REJECTED"],m=["FULFILLED"],b=["PENDING"];function y(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,d!==l&&f(this,d)}function k(d,v,x){this.promise=d,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function c(d,v,x){r(function(){var I;try{I=v(x)}catch(C){return s.reject(d,C)}I===d?s.reject(d,new TypeError("Cannot resolve promise with itself")):s.resolve(d,I)})}function w(d){var v=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof v=="function")return function(){v.apply(d,arguments)}}function f(d,v){var x=!1;function I(P){x||(x=!0,s.reject(d,P))}function C(P){x||(x=!0,s.resolve(d,P))}var L=g(function(){v(C,I)});L.status==="error"&&I(L.value)}function g(d,v){var x={};try{x.value=d(v),x.status="success"}catch(I){x.status="error",x.value=I}return x}(h.exports=y).prototype.finally=function(d){if(typeof d!="function")return this;var v=this.constructor;return this.then(function(x){return v.resolve(d()).then(function(){return x})},function(x){return v.resolve(d()).then(function(){throw x})})},y.prototype.catch=function(d){return this.then(null,d)},y.prototype.then=function(d,v){if(typeof d!="function"&&this.state===m||typeof v!="function"&&this.state===o)return this;var x=new this.constructor(l);return this.state!==b?c(x,this.state===m?d:v,this.outcome):this.queue.push(new k(x,d,v)),x},k.prototype.callFulfilled=function(d){s.resolve(this.promise,d)},k.prototype.otherCallFulfilled=function(d){c(this.promise,this.onFulfilled,d)},k.prototype.callRejected=function(d){s.reject(this.promise,d)},k.prototype.otherCallRejected=function(d){c(this.promise,this.onRejected,d)},s.resolve=function(d,v){var x=g(w,v);if(x.status==="error")return s.reject(d,x.value);var I=x.value;if(I)f(d,I);else{d.state=m,d.outcome=v;for(var C=-1,L=d.queue.length;++C<L;)d.queue[C].callFulfilled(v)}return d},s.reject=function(d,v){d.state=o,d.outcome=v;for(var x=-1,I=d.queue.length;++x<I;)d.queue[x].callRejected(v);return d},y.resolve=function(d){return d instanceof this?d:s.resolve(new this(l),d)},y.reject=function(d){var v=new this(l);return s.reject(v,d)},y.all=function(d){var v=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=d.length,I=!1;if(!x)return this.resolve([]);for(var C=new Array(x),L=0,P=-1,Z=new this(l);++P<x;)O(d[P],P);return Z;function O(G,J){v.resolve(G).then(function(E){C[J]=E,++L!==x||I||(I=!0,s.resolve(Z,C))},function(E){I||(I=!0,s.reject(Z,E))})}},y.race=function(d){var v=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=d.length,I=!1;if(!x)return this.resolve([]);for(var C=-1,L=new this(l);++C<x;)P=d[C],v.resolve(P).then(function(Z){I||(I=!0,s.resolve(L,Z))},function(Z){I||(I=!0,s.reject(L,Z))});var P;return L}},{immediate:36}],38:[function(t,h,a){var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),h.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,h,a){var r=t("./zlib/deflate"),l=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/messages"),m=t("./zlib/zstream"),b=Object.prototype.toString,y=0,k=-1,c=0,w=8;function f(d){if(!(this instanceof f))return new f(d);this.options=l.assign({level:k,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},d||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var x=r.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(x!==y)throw new Error(o[x]);if(v.header&&r.deflateSetHeader(this.strm,v.header),v.dictionary){var I;if(I=typeof v.dictionary=="string"?s.string2buf(v.dictionary):b.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(x=r.deflateSetDictionary(this.strm,I))!==y)throw new Error(o[x]);this._dict_set=!0}}function g(d,v){var x=new f(v);if(x.push(d,!0),x.err)throw x.msg||o[x.err];return x.result}f.prototype.push=function(d,v){var x,I,C=this.strm,L=this.options.chunkSize;if(this.ended)return!1;I=v===~~v?v:v===!0?4:0,typeof d=="string"?C.input=s.string2buf(d):b.call(d)==="[object ArrayBuffer]"?C.input=new Uint8Array(d):C.input=d,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new l.Buf8(L),C.next_out=0,C.avail_out=L),(x=r.deflate(C,I))!==1&&x!==y)return this.onEnd(x),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(l.shrinkBuf(C.output,C.next_out))):this.onData(l.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&x!==1);return I===4?(x=r.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===y):I!==2||(this.onEnd(y),!(C.avail_out=0))},f.prototype.onData=function(d){this.chunks.push(d)},f.prototype.onEnd=function(d){d===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},a.Deflate=f,a.deflate=g,a.deflateRaw=function(d,v){return(v=v||{}).raw=!0,g(d,v)},a.gzip=function(d,v){return(v=v||{}).gzip=!0,g(d,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,h,a){var r=t("./zlib/inflate"),l=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/constants"),m=t("./zlib/messages"),b=t("./zlib/zstream"),y=t("./zlib/gzheader"),k=Object.prototype.toString;function c(f){if(!(this instanceof c))return new c(f);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},f||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||f&&f.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&(15&g.windowBits)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var d=r.inflateInit2(this.strm,g.windowBits);if(d!==o.Z_OK)throw new Error(m[d]);this.header=new y,r.inflateGetHeader(this.strm,this.header)}function w(f,g){var d=new c(g);if(d.push(f,!0),d.err)throw d.msg||m[d.err];return d.result}c.prototype.push=function(f,g){var d,v,x,I,C,L,P=this.strm,Z=this.options.chunkSize,O=this.options.dictionary,G=!1;if(this.ended)return!1;v=g===~~g?g:g===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof f=="string"?P.input=s.binstring2buf(f):k.call(f)==="[object ArrayBuffer]"?P.input=new Uint8Array(f):P.input=f,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new l.Buf8(Z),P.next_out=0,P.avail_out=Z),(d=r.inflate(P,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&O&&(L=typeof O=="string"?s.string2buf(O):k.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,d=r.inflateSetDictionary(this.strm,L)),d===o.Z_BUF_ERROR&&G===!0&&(d=o.Z_OK,G=!1),d!==o.Z_STREAM_END&&d!==o.Z_OK)return this.onEnd(d),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&d!==o.Z_STREAM_END&&(P.avail_in!==0||v!==o.Z_FINISH&&v!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=s.utf8border(P.output,P.next_out),I=P.next_out-x,C=s.buf2string(P.output,x),P.next_out=I,P.avail_out=Z-I,I&&l.arraySet(P.output,P.output,x,I,0),this.onData(C)):this.onData(l.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(G=!0)}while((0<P.avail_in||P.avail_out===0)&&d!==o.Z_STREAM_END);return d===o.Z_STREAM_END&&(v=o.Z_FINISH),v===o.Z_FINISH?(d=r.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===o.Z_OK):v!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(P.avail_out=0))},c.prototype.onData=function(f){this.chunks.push(f)},c.prototype.onEnd=function(f){f===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},a.Inflate=c,a.inflate=w,a.inflateRaw=function(f,g){return(g=g||{}).raw=!0,w(f,g)},a.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,h,a){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(o){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var b=m.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var y in b)b.hasOwnProperty(y)&&(o[y]=b[y])}}return o},a.shrinkBuf=function(o,m){return o.length===m?o:o.subarray?o.subarray(0,m):(o.length=m,o)};var l={arraySet:function(o,m,b,y,k){if(m.subarray&&o.subarray)o.set(m.subarray(b,b+y),k);else for(var c=0;c<y;c++)o[k+c]=m[b+c]},flattenChunks:function(o){var m,b,y,k,c,w;for(m=y=0,b=o.length;m<b;m++)y+=o[m].length;for(w=new Uint8Array(y),m=k=0,b=o.length;m<b;m++)c=o[m],w.set(c,k),k+=c.length;return w}},s={arraySet:function(o,m,b,y,k){for(var c=0;c<y;c++)o[k+c]=m[b+c]},flattenChunks:function(o){return[].concat.apply([],o)}};a.setTyped=function(o){o?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(r)},{}],42:[function(t,h,a){var r=t("./common"),l=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new r.Buf8(256),m=0;m<256;m++)o[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function b(y,k){if(k<65537&&(y.subarray&&s||!y.subarray&&l))return String.fromCharCode.apply(null,r.shrinkBuf(y,k));for(var c="",w=0;w<k;w++)c+=String.fromCharCode(y[w]);return c}o[254]=o[254]=1,a.string2buf=function(y){var k,c,w,f,g,d=y.length,v=0;for(f=0;f<d;f++)(64512&(c=y.charCodeAt(f)))==55296&&f+1<d&&(64512&(w=y.charCodeAt(f+1)))==56320&&(c=65536+(c-55296<<10)+(w-56320),f++),v+=c<128?1:c<2048?2:c<65536?3:4;for(k=new r.Buf8(v),f=g=0;g<v;f++)(64512&(c=y.charCodeAt(f)))==55296&&f+1<d&&(64512&(w=y.charCodeAt(f+1)))==56320&&(c=65536+(c-55296<<10)+(w-56320),f++),c<128?k[g++]=c:(c<2048?k[g++]=192|c>>>6:(c<65536?k[g++]=224|c>>>12:(k[g++]=240|c>>>18,k[g++]=128|c>>>12&63),k[g++]=128|c>>>6&63),k[g++]=128|63&c);return k},a.buf2binstring=function(y){return b(y,y.length)},a.binstring2buf=function(y){for(var k=new r.Buf8(y.length),c=0,w=k.length;c<w;c++)k[c]=y.charCodeAt(c);return k},a.buf2string=function(y,k){var c,w,f,g,d=k||y.length,v=new Array(2*d);for(c=w=0;c<d;)if((f=y[c++])<128)v[w++]=f;else if(4<(g=o[f]))v[w++]=65533,c+=g-1;else{for(f&=g===2?31:g===3?15:7;1<g&&c<d;)f=f<<6|63&y[c++],g--;1<g?v[w++]=65533:f<65536?v[w++]=f:(f-=65536,v[w++]=55296|f>>10&1023,v[w++]=56320|1023&f)}return b(v,w)},a.utf8border=function(y,k){var c;for((k=k||y.length)>y.length&&(k=y.length),c=k-1;0<=c&&(192&y[c])==128;)c--;return c<0||c===0?k:c+o[y[c]]>k?c:k}},{"./common":41}],43:[function(t,h,a){h.exports=function(r,l,s,o){for(var m=65535&r|0,b=r>>>16&65535|0,y=0;s!==0;){for(s-=y=2e3<s?2e3:s;b=b+(m=m+l[o++]|0)|0,--y;);m%=65521,b%=65521}return m|b<<16|0}},{}],44:[function(t,h,a){h.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,h,a){var r=function(){for(var l,s=[],o=0;o<256;o++){l=o;for(var m=0;m<8;m++)l=1&l?3988292384^l>>>1:l>>>1;s[o]=l}return s}();h.exports=function(l,s,o,m){var b=r,y=m+o;l^=-1;for(var k=m;k<y;k++)l=l>>>8^b[255&(l^s[k])];return-1^l}},{}],46:[function(t,h,a){var r,l=t("../utils/common"),s=t("./trees"),o=t("./adler32"),m=t("./crc32"),b=t("./messages"),y=0,k=4,c=0,w=-2,f=-1,g=4,d=2,v=8,x=9,I=286,C=30,L=19,P=2*I+1,Z=15,O=3,G=258,J=G+O+1,E=42,F=113,u=1,R=2,Q=3,M=4;function tt(n,B){return n.msg=b[B],B}function W(n){return(n<<1)-(4<n?9:0)}function D(n){for(var B=n.length;0<=--B;)n[B]=0}function z(n){var B=n.state,N=B.pending;N>n.avail_out&&(N=n.avail_out),N!==0&&(l.arraySet(n.output,B.pending_buf,B.pending_out,N,n.next_out),n.next_out+=N,B.pending_out+=N,n.total_out+=N,n.avail_out-=N,B.pending-=N,B.pending===0&&(B.pending_out=0))}function T(n,B){s._tr_flush_block(n,0<=n.block_start?n.block_start:-1,n.strstart-n.block_start,B),n.block_start=n.strstart,z(n.strm)}function q(n,B){n.pending_buf[n.pending++]=B}function X(n,B){n.pending_buf[n.pending++]=B>>>8&255,n.pending_buf[n.pending++]=255&B}function H(n,B){var N,_,p=n.max_chain_length,S=n.strstart,U=n.prev_length,j=n.nice_match,A=n.strstart>n.w_size-J?n.strstart-(n.w_size-J):0,$=n.window,Y=n.w_mask,V=n.prev,K=n.strstart+G,it=$[S+U-1],rt=$[S+U];n.prev_length>=n.good_match&&(p>>=2),j>n.lookahead&&(j=n.lookahead);do if($[(N=B)+U]===rt&&$[N+U-1]===it&&$[N]===$[S]&&$[++N]===$[S+1]){S+=2,N++;do;while($[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&$[++S]===$[++N]&&S<K);if(_=G-(K-S),S=K-G,U<_){if(n.match_start=B,j<=(U=_))break;it=$[S+U-1],rt=$[S+U]}}while((B=V[B&Y])>A&&--p!=0);return U<=n.lookahead?U:n.lookahead}function st(n){var B,N,_,p,S,U,j,A,$,Y,V=n.w_size;do{if(p=n.window_size-n.lookahead-n.strstart,n.strstart>=V+(V-J)){for(l.arraySet(n.window,n.window,V,V,0),n.match_start-=V,n.strstart-=V,n.block_start-=V,B=N=n.hash_size;_=n.head[--B],n.head[B]=V<=_?_-V:0,--N;);for(B=N=V;_=n.prev[--B],n.prev[B]=V<=_?_-V:0,--N;);p+=V}if(n.strm.avail_in===0)break;if(U=n.strm,j=n.window,A=n.strstart+n.lookahead,$=p,Y=void 0,Y=U.avail_in,$<Y&&(Y=$),N=Y===0?0:(U.avail_in-=Y,l.arraySet(j,U.input,U.next_in,Y,A),U.state.wrap===1?U.adler=o(U.adler,j,Y,A):U.state.wrap===2&&(U.adler=m(U.adler,j,Y,A)),U.next_in+=Y,U.total_in+=Y,Y),n.lookahead+=N,n.lookahead+n.insert>=O)for(S=n.strstart-n.insert,n.ins_h=n.window[S],n.ins_h=(n.ins_h<<n.hash_shift^n.window[S+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[S+O-1])&n.hash_mask,n.prev[S&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=S,S++,n.insert--,!(n.lookahead+n.insert<O)););}while(n.lookahead<J&&n.strm.avail_in!==0)}function ht(n,B){for(var N,_;;){if(n.lookahead<J){if(st(n),n.lookahead<J&&B===y)return u;if(n.lookahead===0)break}if(N=0,n.lookahead>=O&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+O-1])&n.hash_mask,N=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),N!==0&&n.strstart-N<=n.w_size-J&&(n.match_length=H(n,N)),n.match_length>=O)if(_=s._tr_tally(n,n.strstart-n.match_start,n.match_length-O),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=O){for(n.match_length--;n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+O-1])&n.hash_mask,N=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart,--n.match_length!=0;);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else _=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(_&&(T(n,!1),n.strm.avail_out===0))return u}return n.insert=n.strstart<O-1?n.strstart:O-1,B===k?(T(n,!0),n.strm.avail_out===0?Q:M):n.last_lit&&(T(n,!1),n.strm.avail_out===0)?u:R}function et(n,B){for(var N,_,p;;){if(n.lookahead<J){if(st(n),n.lookahead<J&&B===y)return u;if(n.lookahead===0)break}if(N=0,n.lookahead>=O&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+O-1])&n.hash_mask,N=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=O-1,N!==0&&n.prev_length<n.max_lazy_match&&n.strstart-N<=n.w_size-J&&(n.match_length=H(n,N),n.match_length<=5&&(n.strategy===1||n.match_length===O&&4096<n.strstart-n.match_start)&&(n.match_length=O-1)),n.prev_length>=O&&n.match_length<=n.prev_length){for(p=n.strstart+n.lookahead-O,_=s._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-O),n.lookahead-=n.prev_length-1,n.prev_length-=2;++n.strstart<=p&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+O-1])&n.hash_mask,N=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),--n.prev_length!=0;);if(n.match_available=0,n.match_length=O-1,n.strstart++,_&&(T(n,!1),n.strm.avail_out===0))return u}else if(n.match_available){if((_=s._tr_tally(n,0,n.window[n.strstart-1]))&&T(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return u}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(_=s._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<O-1?n.strstart:O-1,B===k?(T(n,!0),n.strm.avail_out===0?Q:M):n.last_lit&&(T(n,!1),n.strm.avail_out===0)?u:R}function nt(n,B,N,_,p){this.good_length=n,this.max_lazy=B,this.nice_length=N,this.max_chain=_,this.func=p}function lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*P),this.dyn_dtree=new l.Buf16(2*(2*C+1)),this.bl_tree=new l.Buf16(2*(2*L+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(Z+1),this.heap=new l.Buf16(2*I+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*I+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(n){var B;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=d,(B=n.state).pending=0,B.pending_out=0,B.wrap<0&&(B.wrap=-B.wrap),B.status=B.wrap?E:F,n.adler=B.wrap===2?0:1,B.last_flush=y,s._tr_init(B),c):tt(n,w)}function pt(n){var B=at(n);return B===c&&function(N){N.window_size=2*N.w_size,D(N.head),N.max_lazy_match=r[N.level].max_lazy,N.good_match=r[N.level].good_length,N.nice_match=r[N.level].nice_length,N.max_chain_length=r[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=O-1,N.match_available=0,N.ins_h=0}(n.state),B}function dt(n,B,N,_,p,S){if(!n)return w;var U=1;if(B===f&&(B=6),_<0?(U=0,_=-_):15<_&&(U=2,_-=16),p<1||x<p||N!==v||_<8||15<_||B<0||9<B||S<0||g<S)return tt(n,w);_===8&&(_=9);var j=new lt;return(n.state=j).strm=n,j.wrap=U,j.gzhead=null,j.w_bits=_,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=p+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+O-1)/O),j.window=new l.Buf8(2*j.w_size),j.head=new l.Buf16(j.hash_size),j.prev=new l.Buf16(j.w_size),j.lit_bufsize=1<<p+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new l.Buf8(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=B,j.strategy=S,j.method=N,pt(n)}r=[new nt(0,0,0,0,function(n,B){var N=65535;for(N>n.pending_buf_size-5&&(N=n.pending_buf_size-5);;){if(n.lookahead<=1){if(st(n),n.lookahead===0&&B===y)return u;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var _=n.block_start+N;if((n.strstart===0||n.strstart>=_)&&(n.lookahead=n.strstart-_,n.strstart=_,T(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-J&&(T(n,!1),n.strm.avail_out===0))return u}return n.insert=0,B===k?(T(n,!0),n.strm.avail_out===0?Q:M):(n.strstart>n.block_start&&(T(n,!1),n.strm.avail_out),u)}),new nt(4,4,8,4,ht),new nt(4,5,16,8,ht),new nt(4,6,32,32,ht),new nt(4,4,16,16,et),new nt(8,16,32,32,et),new nt(8,16,128,128,et),new nt(8,32,128,256,et),new nt(32,128,258,1024,et),new nt(32,258,258,4096,et)],a.deflateInit=function(n,B){return dt(n,B,v,15,8,0)},a.deflateInit2=dt,a.deflateReset=pt,a.deflateResetKeep=at,a.deflateSetHeader=function(n,B){return n&&n.state?n.state.wrap!==2?w:(n.state.gzhead=B,c):w},a.deflate=function(n,B){var N,_,p,S;if(!n||!n.state||5<B||B<0)return n?tt(n,w):w;if(_=n.state,!n.output||!n.input&&n.avail_in!==0||_.status===666&&B!==k)return tt(n,n.avail_out===0?-5:w);if(_.strm=n,N=_.last_flush,_.last_flush=B,_.status===E)if(_.wrap===2)n.adler=0,q(_,31),q(_,139),q(_,8),_.gzhead?(q(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),q(_,255&_.gzhead.time),q(_,_.gzhead.time>>8&255),q(_,_.gzhead.time>>16&255),q(_,_.gzhead.time>>24&255),q(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),q(_,255&_.gzhead.os),_.gzhead.extra&&_.gzhead.extra.length&&(q(_,255&_.gzhead.extra.length),q(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(n.adler=m(n.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=69):(q(_,0),q(_,0),q(_,0),q(_,0),q(_,0),q(_,_.level===9?2:2<=_.strategy||_.level<2?4:0),q(_,3),_.status=F);else{var U=v+(_.w_bits-8<<4)<<8;U|=(2<=_.strategy||_.level<2?0:_.level<6?1:_.level===6?2:3)<<6,_.strstart!==0&&(U|=32),U+=31-U%31,_.status=F,X(_,U),_.strstart!==0&&(X(_,n.adler>>>16),X(_,65535&n.adler)),n.adler=1}if(_.status===69)if(_.gzhead.extra){for(p=_.pending;_.gzindex<(65535&_.gzhead.extra.length)&&(_.pending!==_.pending_buf_size||(_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),z(n),p=_.pending,_.pending!==_.pending_buf_size));)q(_,255&_.gzhead.extra[_.gzindex]),_.gzindex++;_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=73)}else _.status=73;if(_.status===73)if(_.gzhead.name){p=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),z(n),p=_.pending,_.pending===_.pending_buf_size)){S=1;break}S=_.gzindex<_.gzhead.name.length?255&_.gzhead.name.charCodeAt(_.gzindex++):0,q(_,S)}while(S!==0);_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),S===0&&(_.gzindex=0,_.status=91)}else _.status=91;if(_.status===91)if(_.gzhead.comment){p=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),z(n),p=_.pending,_.pending===_.pending_buf_size)){S=1;break}S=_.gzindex<_.gzhead.comment.length?255&_.gzhead.comment.charCodeAt(_.gzindex++):0,q(_,S)}while(S!==0);_.gzhead.hcrc&&_.pending>p&&(n.adler=m(n.adler,_.pending_buf,_.pending-p,p)),S===0&&(_.status=103)}else _.status=103;if(_.status===103&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&z(n),_.pending+2<=_.pending_buf_size&&(q(_,255&n.adler),q(_,n.adler>>8&255),n.adler=0,_.status=F)):_.status=F),_.pending!==0){if(z(n),n.avail_out===0)return _.last_flush=-1,c}else if(n.avail_in===0&&W(B)<=W(N)&&B!==k)return tt(n,-5);if(_.status===666&&n.avail_in!==0)return tt(n,-5);if(n.avail_in!==0||_.lookahead!==0||B!==y&&_.status!==666){var j=_.strategy===2?function(A,$){for(var Y;;){if(A.lookahead===0&&(st(A),A.lookahead===0)){if($===y)return u;break}if(A.match_length=0,Y=s._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++,Y&&(T(A,!1),A.strm.avail_out===0))return u}return A.insert=0,$===k?(T(A,!0),A.strm.avail_out===0?Q:M):A.last_lit&&(T(A,!1),A.strm.avail_out===0)?u:R}(_,B):_.strategy===3?function(A,$){for(var Y,V,K,it,rt=A.window;;){if(A.lookahead<=G){if(st(A),A.lookahead<=G&&$===y)return u;if(A.lookahead===0)break}if(A.match_length=0,A.lookahead>=O&&0<A.strstart&&(V=rt[K=A.strstart-1])===rt[++K]&&V===rt[++K]&&V===rt[++K]){it=A.strstart+G;do;while(V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&V===rt[++K]&&K<it);A.match_length=G-(it-K),A.match_length>A.lookahead&&(A.match_length=A.lookahead)}if(A.match_length>=O?(Y=s._tr_tally(A,1,A.match_length-O),A.lookahead-=A.match_length,A.strstart+=A.match_length,A.match_length=0):(Y=s._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++),Y&&(T(A,!1),A.strm.avail_out===0))return u}return A.insert=0,$===k?(T(A,!0),A.strm.avail_out===0?Q:M):A.last_lit&&(T(A,!1),A.strm.avail_out===0)?u:R}(_,B):r[_.level].func(_,B);if(j!==Q&&j!==M||(_.status=666),j===u||j===Q)return n.avail_out===0&&(_.last_flush=-1),c;if(j===R&&(B===1?s._tr_align(_):B!==5&&(s._tr_stored_block(_,0,0,!1),B===3&&(D(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),z(n),n.avail_out===0))return _.last_flush=-1,c}return B!==k?c:_.wrap<=0?1:(_.wrap===2?(q(_,255&n.adler),q(_,n.adler>>8&255),q(_,n.adler>>16&255),q(_,n.adler>>24&255),q(_,255&n.total_in),q(_,n.total_in>>8&255),q(_,n.total_in>>16&255),q(_,n.total_in>>24&255)):(X(_,n.adler>>>16),X(_,65535&n.adler)),z(n),0<_.wrap&&(_.wrap=-_.wrap),_.pending!==0?c:1)},a.deflateEnd=function(n){var B;return n&&n.state?(B=n.state.status)!==E&&B!==69&&B!==73&&B!==91&&B!==103&&B!==F&&B!==666?tt(n,w):(n.state=null,B===F?tt(n,-3):c):w},a.deflateSetDictionary=function(n,B){var N,_,p,S,U,j,A,$,Y=B.length;if(!n||!n.state||(S=(N=n.state).wrap)===2||S===1&&N.status!==E||N.lookahead)return w;for(S===1&&(n.adler=o(n.adler,B,Y,0)),N.wrap=0,Y>=N.w_size&&(S===0&&(D(N.head),N.strstart=0,N.block_start=0,N.insert=0),$=new l.Buf8(N.w_size),l.arraySet($,B,Y-N.w_size,N.w_size,0),B=$,Y=N.w_size),U=n.avail_in,j=n.next_in,A=n.input,n.avail_in=Y,n.next_in=0,n.input=B,st(N);N.lookahead>=O;){for(_=N.strstart,p=N.lookahead-(O-1);N.ins_h=(N.ins_h<<N.hash_shift^N.window[_+O-1])&N.hash_mask,N.prev[_&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=_,_++,--p;);N.strstart=_,N.lookahead=O-1,st(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=O-1,N.match_available=0,n.next_in=j,n.input=A,n.avail_in=U,N.wrap=S,c},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,h,a){h.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,h,a){h.exports=function(r,l){var s,o,m,b,y,k,c,w,f,g,d,v,x,I,C,L,P,Z,O,G,J,E,F,u,R;s=r.state,o=r.next_in,u=r.input,m=o+(r.avail_in-5),b=r.next_out,R=r.output,y=b-(l-r.avail_out),k=b+(r.avail_out-257),c=s.dmax,w=s.wsize,f=s.whave,g=s.wnext,d=s.window,v=s.hold,x=s.bits,I=s.lencode,C=s.distcode,L=(1<<s.lenbits)-1,P=(1<<s.distbits)-1;t:do{x<15&&(v+=u[o++]<<x,x+=8,v+=u[o++]<<x,x+=8),Z=I[v&L];e:for(;;){if(v>>>=O=Z>>>24,x-=O,(O=Z>>>16&255)===0)R[b++]=65535&Z;else{if(!(16&O)){if((64&O)==0){Z=I[(65535&Z)+(v&(1<<O)-1)];continue e}if(32&O){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}G=65535&Z,(O&=15)&&(x<O&&(v+=u[o++]<<x,x+=8),G+=v&(1<<O)-1,v>>>=O,x-=O),x<15&&(v+=u[o++]<<x,x+=8,v+=u[o++]<<x,x+=8),Z=C[v&P];r:for(;;){if(v>>>=O=Z>>>24,x-=O,!(16&(O=Z>>>16&255))){if((64&O)==0){Z=C[(65535&Z)+(v&(1<<O)-1)];continue r}r.msg="invalid distance code",s.mode=30;break t}if(J=65535&Z,x<(O&=15)&&(v+=u[o++]<<x,(x+=8)<O&&(v+=u[o++]<<x,x+=8)),c<(J+=v&(1<<O)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(v>>>=O,x-=O,(O=b-y)<J){if(f<(O=J-O)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if(F=d,(E=0)===g){if(E+=w-O,O<G){for(G-=O;R[b++]=d[E++],--O;);E=b-J,F=R}}else if(g<O){if(E+=w+g-O,(O-=g)<G){for(G-=O;R[b++]=d[E++],--O;);if(E=0,g<G){for(G-=O=g;R[b++]=d[E++],--O;);E=b-J,F=R}}}else if(E+=g-O,O<G){for(G-=O;R[b++]=d[E++],--O;);E=b-J,F=R}for(;2<G;)R[b++]=F[E++],R[b++]=F[E++],R[b++]=F[E++],G-=3;G&&(R[b++]=F[E++],1<G&&(R[b++]=F[E++]))}else{for(E=b-J;R[b++]=R[E++],R[b++]=R[E++],R[b++]=R[E++],2<(G-=3););G&&(R[b++]=R[E++],1<G&&(R[b++]=R[E++]))}break}}break}}while(o<m&&b<k);o-=G=x>>3,v&=(1<<(x-=G<<3))-1,r.next_in=o,r.next_out=b,r.avail_in=o<m?m-o+5:5-(o-m),r.avail_out=b<k?k-b+257:257-(b-k),s.hold=v,s.bits=x}},{}],49:[function(t,h,a){var r=t("../utils/common"),l=t("./adler32"),s=t("./crc32"),o=t("./inffast"),m=t("./inftrees"),b=1,y=2,k=0,c=-2,w=1,f=852,g=592;function d(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(E){var F;return E&&E.state?(F=E.state,E.total_in=E.total_out=F.total=0,E.msg="",F.wrap&&(E.adler=1&F.wrap),F.mode=w,F.last=0,F.havedict=0,F.dmax=32768,F.head=null,F.hold=0,F.bits=0,F.lencode=F.lendyn=new r.Buf32(f),F.distcode=F.distdyn=new r.Buf32(g),F.sane=1,F.back=-1,k):c}function I(E){var F;return E&&E.state?((F=E.state).wsize=0,F.whave=0,F.wnext=0,x(E)):c}function C(E,F){var u,R;return E&&E.state?(R=E.state,F<0?(u=0,F=-F):(u=1+(F>>4),F<48&&(F&=15)),F&&(F<8||15<F)?c:(R.window!==null&&R.wbits!==F&&(R.window=null),R.wrap=u,R.wbits=F,I(E))):c}function L(E,F){var u,R;return E?(R=new v,(E.state=R).window=null,(u=C(E,F))!==k&&(E.state=null),u):c}var P,Z,O=!0;function G(E){if(O){var F;for(P=new r.Buf32(512),Z=new r.Buf32(32),F=0;F<144;)E.lens[F++]=8;for(;F<256;)E.lens[F++]=9;for(;F<280;)E.lens[F++]=7;for(;F<288;)E.lens[F++]=8;for(m(b,E.lens,0,288,P,0,E.work,{bits:9}),F=0;F<32;)E.lens[F++]=5;m(y,E.lens,0,32,Z,0,E.work,{bits:5}),O=!1}E.lencode=P,E.lenbits=9,E.distcode=Z,E.distbits=5}function J(E,F,u,R){var Q,M=E.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new r.Buf8(M.wsize)),R>=M.wsize?(r.arraySet(M.window,F,u-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(R<(Q=M.wsize-M.wnext)&&(Q=R),r.arraySet(M.window,F,u-R,Q,M.wnext),(R-=Q)?(r.arraySet(M.window,F,u-R,R,0),M.wnext=R,M.whave=M.wsize):(M.wnext+=Q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=Q))),0}a.inflateReset=I,a.inflateReset2=C,a.inflateResetKeep=x,a.inflateInit=function(E){return L(E,15)},a.inflateInit2=L,a.inflate=function(E,F){var u,R,Q,M,tt,W,D,z,T,q,X,H,st,ht,et,nt,lt,at,pt,dt,n,B,N,_,p=0,S=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return c;(u=E.state).mode===12&&(u.mode=13),tt=E.next_out,Q=E.output,D=E.avail_out,M=E.next_in,R=E.input,W=E.avail_in,z=u.hold,T=u.bits,q=W,X=D,B=k;t:for(;;)switch(u.mode){case w:if(u.wrap===0){u.mode=13;break}for(;T<16;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(2&u.wrap&&z===35615){S[u.check=0]=255&z,S[1]=z>>>8&255,u.check=s(u.check,S,2,0),T=z=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&z)<<8)+(z>>8))%31){E.msg="incorrect header check",u.mode=30;break}if((15&z)!=8){E.msg="unknown compression method",u.mode=30;break}if(T-=4,n=8+(15&(z>>>=4)),u.wbits===0)u.wbits=n;else if(n>u.wbits){E.msg="invalid window size",u.mode=30;break}u.dmax=1<<n,E.adler=u.check=1,u.mode=512&z?10:12,T=z=0;break;case 2:for(;T<16;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(u.flags=z,(255&u.flags)!=8){E.msg="unknown compression method",u.mode=30;break}if(57344&u.flags){E.msg="unknown header flags set",u.mode=30;break}u.head&&(u.head.text=z>>8&1),512&u.flags&&(S[0]=255&z,S[1]=z>>>8&255,u.check=s(u.check,S,2,0)),T=z=0,u.mode=3;case 3:for(;T<32;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.head&&(u.head.time=z),512&u.flags&&(S[0]=255&z,S[1]=z>>>8&255,S[2]=z>>>16&255,S[3]=z>>>24&255,u.check=s(u.check,S,4,0)),T=z=0,u.mode=4;case 4:for(;T<16;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.head&&(u.head.xflags=255&z,u.head.os=z>>8),512&u.flags&&(S[0]=255&z,S[1]=z>>>8&255,u.check=s(u.check,S,2,0)),T=z=0,u.mode=5;case 5:if(1024&u.flags){for(;T<16;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.length=z,u.head&&(u.head.extra_len=z),512&u.flags&&(S[0]=255&z,S[1]=z>>>8&255,u.check=s(u.check,S,2,0)),T=z=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&(W<(H=u.length)&&(H=W),H&&(u.head&&(n=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),r.arraySet(u.head.extra,R,M,H,n)),512&u.flags&&(u.check=s(u.check,R,H,M)),W-=H,M+=H,u.length-=H),u.length))break t;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(W===0)break t;for(H=0;n=R[M+H++],u.head&&n&&u.length<65536&&(u.head.name+=String.fromCharCode(n)),n&&H<W;);if(512&u.flags&&(u.check=s(u.check,R,H,M)),W-=H,M+=H,n)break t}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(W===0)break t;for(H=0;n=R[M+H++],u.head&&n&&u.length<65536&&(u.head.comment+=String.fromCharCode(n)),n&&H<W;);if(512&u.flags&&(u.check=s(u.check,R,H,M)),W-=H,M+=H,n)break t}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;T<16;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(z!==(65535&u.check)){E.msg="header crc mismatch",u.mode=30;break}T=z=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),E.adler=u.check=0,u.mode=12;break;case 10:for(;T<32;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}E.adler=u.check=d(z),T=z=0,u.mode=11;case 11:if(u.havedict===0)return E.next_out=tt,E.avail_out=D,E.next_in=M,E.avail_in=W,u.hold=z,u.bits=T,2;E.adler=u.check=1,u.mode=12;case 12:if(F===5||F===6)break t;case 13:if(u.last){z>>>=7&T,T-=7&T,u.mode=27;break}for(;T<3;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}switch(u.last=1&z,T-=1,3&(z>>>=1)){case 0:u.mode=14;break;case 1:if(G(u),u.mode=20,F!==6)break;z>>>=2,T-=2;break t;case 2:u.mode=17;break;case 3:E.msg="invalid block type",u.mode=30}z>>>=2,T-=2;break;case 14:for(z>>>=7&T,T-=7&T;T<32;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if((65535&z)!=(z>>>16^65535)){E.msg="invalid stored block lengths",u.mode=30;break}if(u.length=65535&z,T=z=0,u.mode=15,F===6)break t;case 15:u.mode=16;case 16:if(H=u.length){if(W<H&&(H=W),D<H&&(H=D),H===0)break t;r.arraySet(Q,R,M,H,tt),W-=H,M+=H,D-=H,tt+=H,u.length-=H;break}u.mode=12;break;case 17:for(;T<14;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(u.nlen=257+(31&z),z>>>=5,T-=5,u.ndist=1+(31&z),z>>>=5,T-=5,u.ncode=4+(15&z),z>>>=4,T-=4,286<u.nlen||30<u.ndist){E.msg="too many length or distance symbols",u.mode=30;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;T<3;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.lens[U[u.have++]]=7&z,z>>>=3,T-=3}for(;u.have<19;)u.lens[U[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,N={bits:u.lenbits},B=m(0,u.lens,0,19,u.lencode,0,u.work,N),u.lenbits=N.bits,B){E.msg="invalid code lengths set",u.mode=30;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;nt=(p=u.lencode[z&(1<<u.lenbits)-1])>>>16&255,lt=65535&p,!((et=p>>>24)<=T);){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(lt<16)z>>>=et,T-=et,u.lens[u.have++]=lt;else{if(lt===16){for(_=et+2;T<_;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(z>>>=et,T-=et,u.have===0){E.msg="invalid bit length repeat",u.mode=30;break}n=u.lens[u.have-1],H=3+(3&z),z>>>=2,T-=2}else if(lt===17){for(_=et+3;T<_;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}T-=et,n=0,H=3+(7&(z>>>=et)),z>>>=3,T-=3}else{for(_=et+7;T<_;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}T-=et,n=0,H=11+(127&(z>>>=et)),z>>>=7,T-=7}if(u.have+H>u.nlen+u.ndist){E.msg="invalid bit length repeat",u.mode=30;break}for(;H--;)u.lens[u.have++]=n}}if(u.mode===30)break;if(u.lens[256]===0){E.msg="invalid code -- missing end-of-block",u.mode=30;break}if(u.lenbits=9,N={bits:u.lenbits},B=m(b,u.lens,0,u.nlen,u.lencode,0,u.work,N),u.lenbits=N.bits,B){E.msg="invalid literal/lengths set",u.mode=30;break}if(u.distbits=6,u.distcode=u.distdyn,N={bits:u.distbits},B=m(y,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,N),u.distbits=N.bits,B){E.msg="invalid distances set",u.mode=30;break}if(u.mode=20,F===6)break t;case 20:u.mode=21;case 21:if(6<=W&&258<=D){E.next_out=tt,E.avail_out=D,E.next_in=M,E.avail_in=W,u.hold=z,u.bits=T,o(E,X),tt=E.next_out,Q=E.output,D=E.avail_out,M=E.next_in,R=E.input,W=E.avail_in,z=u.hold,T=u.bits,u.mode===12&&(u.back=-1);break}for(u.back=0;nt=(p=u.lencode[z&(1<<u.lenbits)-1])>>>16&255,lt=65535&p,!((et=p>>>24)<=T);){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(nt&&(240&nt)==0){for(at=et,pt=nt,dt=lt;nt=(p=u.lencode[dt+((z&(1<<at+pt)-1)>>at)])>>>16&255,lt=65535&p,!(at+(et=p>>>24)<=T);){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}z>>>=at,T-=at,u.back+=at}if(z>>>=et,T-=et,u.back+=et,u.length=lt,nt===0){u.mode=26;break}if(32&nt){u.back=-1,u.mode=12;break}if(64&nt){E.msg="invalid literal/length code",u.mode=30;break}u.extra=15&nt,u.mode=22;case 22:if(u.extra){for(_=u.extra;T<_;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.length+=z&(1<<u.extra)-1,z>>>=u.extra,T-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;nt=(p=u.distcode[z&(1<<u.distbits)-1])>>>16&255,lt=65535&p,!((et=p>>>24)<=T);){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if((240&nt)==0){for(at=et,pt=nt,dt=lt;nt=(p=u.distcode[dt+((z&(1<<at+pt)-1)>>at)])>>>16&255,lt=65535&p,!(at+(et=p>>>24)<=T);){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}z>>>=at,T-=at,u.back+=at}if(z>>>=et,T-=et,u.back+=et,64&nt){E.msg="invalid distance code",u.mode=30;break}u.offset=lt,u.extra=15&nt,u.mode=24;case 24:if(u.extra){for(_=u.extra;T<_;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}u.offset+=z&(1<<u.extra)-1,z>>>=u.extra,T-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){E.msg="invalid distance too far back",u.mode=30;break}u.mode=25;case 25:if(D===0)break t;if(H=X-D,u.offset>H){if((H=u.offset-H)>u.whave&&u.sane){E.msg="invalid distance too far back",u.mode=30;break}st=H>u.wnext?(H-=u.wnext,u.wsize-H):u.wnext-H,H>u.length&&(H=u.length),ht=u.window}else ht=Q,st=tt-u.offset,H=u.length;for(D<H&&(H=D),D-=H,u.length-=H;Q[tt++]=ht[st++],--H;);u.length===0&&(u.mode=21);break;case 26:if(D===0)break t;Q[tt++]=u.length,D--,u.mode=21;break;case 27:if(u.wrap){for(;T<32;){if(W===0)break t;W--,z|=R[M++]<<T,T+=8}if(X-=D,E.total_out+=X,u.total+=X,X&&(E.adler=u.check=u.flags?s(u.check,Q,X,tt-X):l(u.check,Q,X,tt-X)),X=D,(u.flags?z:d(z))!==u.check){E.msg="incorrect data check",u.mode=30;break}T=z=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;T<32;){if(W===0)break t;W--,z+=R[M++]<<T,T+=8}if(z!==(4294967295&u.total)){E.msg="incorrect length check",u.mode=30;break}T=z=0}u.mode=29;case 29:B=1;break t;case 30:B=-3;break t;case 31:return-4;case 32:default:return c}return E.next_out=tt,E.avail_out=D,E.next_in=M,E.avail_in=W,u.hold=z,u.bits=T,(u.wsize||X!==E.avail_out&&u.mode<30&&(u.mode<27||F!==4))&&J(E,E.output,E.next_out,X-E.avail_out)?(u.mode=31,-4):(q-=E.avail_in,X-=E.avail_out,E.total_in+=q,E.total_out+=X,u.total+=X,u.wrap&&X&&(E.adler=u.check=u.flags?s(u.check,Q,X,E.next_out-X):l(u.check,Q,X,E.next_out-X)),E.data_type=u.bits+(u.last?64:0)+(u.mode===12?128:0)+(u.mode===20||u.mode===15?256:0),(q==0&&X===0||F===4)&&B===k&&(B=-5),B)},a.inflateEnd=function(E){if(!E||!E.state)return c;var F=E.state;return F.window&&(F.window=null),E.state=null,k},a.inflateGetHeader=function(E,F){var u;return E&&E.state?(2&(u=E.state).wrap)==0?c:((u.head=F).done=!1,k):c},a.inflateSetDictionary=function(E,F){var u,R=F.length;return E&&E.state?(u=E.state).wrap!==0&&u.mode!==11?c:u.mode===11&&l(1,F,R,0)!==u.check?-3:J(E,F,R,R)?(u.mode=31,-4):(u.havedict=1,k):c},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,h,a){var r=t("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];h.exports=function(b,y,k,c,w,f,g,d){var v,x,I,C,L,P,Z,O,G,J=d.bits,E=0,F=0,u=0,R=0,Q=0,M=0,tt=0,W=0,D=0,z=0,T=null,q=0,X=new r.Buf16(16),H=new r.Buf16(16),st=null,ht=0;for(E=0;E<=15;E++)X[E]=0;for(F=0;F<c;F++)X[y[k+F]]++;for(Q=J,R=15;1<=R&&X[R]===0;R--);if(R<Q&&(Q=R),R===0)return w[f++]=20971520,w[f++]=20971520,d.bits=1,0;for(u=1;u<R&&X[u]===0;u++);for(Q<u&&(Q=u),E=W=1;E<=15;E++)if(W<<=1,(W-=X[E])<0)return-1;if(0<W&&(b===0||R!==1))return-1;for(H[1]=0,E=1;E<15;E++)H[E+1]=H[E]+X[E];for(F=0;F<c;F++)y[k+F]!==0&&(g[H[y[k+F]]++]=F);if(P=b===0?(T=st=g,19):b===1?(T=l,q-=257,st=s,ht-=257,256):(T=o,st=m,-1),E=u,L=f,tt=F=z=0,I=-1,C=(D=1<<(M=Q))-1,b===1&&852<D||b===2&&592<D)return 1;for(;;){for(Z=E-tt,G=g[F]<P?(O=0,g[F]):g[F]>P?(O=st[ht+g[F]],T[q+g[F]]):(O=96,0),v=1<<E-tt,u=x=1<<M;w[L+(z>>tt)+(x-=v)]=Z<<24|O<<16|G|0,x!==0;);for(v=1<<E-1;z&v;)v>>=1;if(v!==0?(z&=v-1,z+=v):z=0,F++,--X[E]==0){if(E===R)break;E=y[k+g[F]]}if(Q<E&&(z&C)!==I){for(tt===0&&(tt=Q),L+=u,W=1<<(M=E-tt);M+tt<R&&!((W-=X[M+tt])<=0);)M++,W<<=1;if(D+=1<<M,b===1&&852<D||b===2&&592<D)return 1;w[I=z&C]=Q<<24|M<<16|L-f|0}}return z!==0&&(w[L+z]=E-tt<<24|64<<16|0),d.bits=Q,0}},{"../utils/common":41}],51:[function(t,h,a){h.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,h,a){var r=t("../utils/common"),l=0,s=1;function o(p){for(var S=p.length;0<=--S;)p[S]=0}var m=0,b=29,y=256,k=y+1+b,c=30,w=19,f=2*k+1,g=15,d=16,v=7,x=256,I=16,C=17,L=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=new Array(2*(k+2));o(J);var E=new Array(2*c);o(E);var F=new Array(512);o(F);var u=new Array(256);o(u);var R=new Array(b);o(R);var Q,M,tt,W=new Array(c);function D(p,S,U,j,A){this.static_tree=p,this.extra_bits=S,this.extra_base=U,this.elems=j,this.max_length=A,this.has_stree=p&&p.length}function z(p,S){this.dyn_tree=p,this.max_code=0,this.stat_desc=S}function T(p){return p<256?F[p]:F[256+(p>>>7)]}function q(p,S){p.pending_buf[p.pending++]=255&S,p.pending_buf[p.pending++]=S>>>8&255}function X(p,S,U){p.bi_valid>d-U?(p.bi_buf|=S<<p.bi_valid&65535,q(p,p.bi_buf),p.bi_buf=S>>d-p.bi_valid,p.bi_valid+=U-d):(p.bi_buf|=S<<p.bi_valid&65535,p.bi_valid+=U)}function H(p,S,U){X(p,U[2*S],U[2*S+1])}function st(p,S){for(var U=0;U|=1&p,p>>>=1,U<<=1,0<--S;);return U>>>1}function ht(p,S,U){var j,A,$=new Array(g+1),Y=0;for(j=1;j<=g;j++)$[j]=Y=Y+U[j-1]<<1;for(A=0;A<=S;A++){var V=p[2*A+1];V!==0&&(p[2*A]=st($[V]++,V))}}function et(p){var S;for(S=0;S<k;S++)p.dyn_ltree[2*S]=0;for(S=0;S<c;S++)p.dyn_dtree[2*S]=0;for(S=0;S<w;S++)p.bl_tree[2*S]=0;p.dyn_ltree[2*x]=1,p.opt_len=p.static_len=0,p.last_lit=p.matches=0}function nt(p){8<p.bi_valid?q(p,p.bi_buf):0<p.bi_valid&&(p.pending_buf[p.pending++]=p.bi_buf),p.bi_buf=0,p.bi_valid=0}function lt(p,S,U,j){var A=2*S,$=2*U;return p[A]<p[$]||p[A]===p[$]&&j[S]<=j[U]}function at(p,S,U){for(var j=p.heap[U],A=U<<1;A<=p.heap_len&&(A<p.heap_len&&lt(S,p.heap[A+1],p.heap[A],p.depth)&&A++,!lt(S,j,p.heap[A],p.depth));)p.heap[U]=p.heap[A],U=A,A<<=1;p.heap[U]=j}function pt(p,S,U){var j,A,$,Y,V=0;if(p.last_lit!==0)for(;j=p.pending_buf[p.d_buf+2*V]<<8|p.pending_buf[p.d_buf+2*V+1],A=p.pending_buf[p.l_buf+V],V++,j===0?H(p,A,S):(H(p,($=u[A])+y+1,S),(Y=P[$])!==0&&X(p,A-=R[$],Y),H(p,$=T(--j),U),(Y=Z[$])!==0&&X(p,j-=W[$],Y)),V<p.last_lit;);H(p,x,S)}function dt(p,S){var U,j,A,$=S.dyn_tree,Y=S.stat_desc.static_tree,V=S.stat_desc.has_stree,K=S.stat_desc.elems,it=-1;for(p.heap_len=0,p.heap_max=f,U=0;U<K;U++)$[2*U]!==0?(p.heap[++p.heap_len]=it=U,p.depth[U]=0):$[2*U+1]=0;for(;p.heap_len<2;)$[2*(A=p.heap[++p.heap_len]=it<2?++it:0)]=1,p.depth[A]=0,p.opt_len--,V&&(p.static_len-=Y[2*A+1]);for(S.max_code=it,U=p.heap_len>>1;1<=U;U--)at(p,$,U);for(A=K;U=p.heap[1],p.heap[1]=p.heap[p.heap_len--],at(p,$,1),j=p.heap[1],p.heap[--p.heap_max]=U,p.heap[--p.heap_max]=j,$[2*A]=$[2*U]+$[2*j],p.depth[A]=(p.depth[U]>=p.depth[j]?p.depth[U]:p.depth[j])+1,$[2*U+1]=$[2*j+1]=A,p.heap[1]=A++,at(p,$,1),2<=p.heap_len;);p.heap[--p.heap_max]=p.heap[1],function(rt,ct){var kt,gt,Et,ot,Ct,Pt,mt=ct.dyn_tree,jt=ct.max_code,Kt=ct.stat_desc.static_tree,qt=ct.stat_desc.has_stree,Jt=ct.stat_desc.extra_bits,Mt=ct.stat_desc.extra_base,xt=ct.stat_desc.max_length,It=0;for(ot=0;ot<=g;ot++)rt.bl_count[ot]=0;for(mt[2*rt.heap[rt.heap_max]+1]=0,kt=rt.heap_max+1;kt<f;kt++)xt<(ot=mt[2*mt[2*(gt=rt.heap[kt])+1]+1]+1)&&(ot=xt,It++),mt[2*gt+1]=ot,jt<gt||(rt.bl_count[ot]++,Ct=0,Mt<=gt&&(Ct=Jt[gt-Mt]),Pt=mt[2*gt],rt.opt_len+=Pt*(ot+Ct),qt&&(rt.static_len+=Pt*(Kt[2*gt+1]+Ct)));if(It!==0){do{for(ot=xt-1;rt.bl_count[ot]===0;)ot--;rt.bl_count[ot]--,rt.bl_count[ot+1]+=2,rt.bl_count[xt]--,It-=2}while(0<It);for(ot=xt;ot!==0;ot--)for(gt=rt.bl_count[ot];gt!==0;)jt<(Et=rt.heap[--kt])||(mt[2*Et+1]!==ot&&(rt.opt_len+=(ot-mt[2*Et+1])*mt[2*Et],mt[2*Et+1]=ot),gt--)}}(p,S),ht($,it,p.bl_count)}function n(p,S,U){var j,A,$=-1,Y=S[1],V=0,K=7,it=4;for(Y===0&&(K=138,it=3),S[2*(U+1)+1]=65535,j=0;j<=U;j++)A=Y,Y=S[2*(j+1)+1],++V<K&&A===Y||(V<it?p.bl_tree[2*A]+=V:A!==0?(A!==$&&p.bl_tree[2*A]++,p.bl_tree[2*I]++):V<=10?p.bl_tree[2*C]++:p.bl_tree[2*L]++,$=A,it=(V=0)===Y?(K=138,3):A===Y?(K=6,3):(K=7,4))}function B(p,S,U){var j,A,$=-1,Y=S[1],V=0,K=7,it=4;for(Y===0&&(K=138,it=3),j=0;j<=U;j++)if(A=Y,Y=S[2*(j+1)+1],!(++V<K&&A===Y)){if(V<it)for(;H(p,A,p.bl_tree),--V!=0;);else A!==0?(A!==$&&(H(p,A,p.bl_tree),V--),H(p,I,p.bl_tree),X(p,V-3,2)):V<=10?(H(p,C,p.bl_tree),X(p,V-3,3)):(H(p,L,p.bl_tree),X(p,V-11,7));$=A,it=(V=0)===Y?(K=138,3):A===Y?(K=6,3):(K=7,4)}}o(W);var N=!1;function _(p,S,U,j){X(p,(m<<1)+(j?1:0),3),function(A,$,Y,V){nt(A),V&&(q(A,Y),q(A,~Y)),r.arraySet(A.pending_buf,A.window,$,Y,A.pending),A.pending+=Y}(p,S,U,!0)}a._tr_init=function(p){N||(function(){var S,U,j,A,$,Y=new Array(g+1);for(A=j=0;A<b-1;A++)for(R[A]=j,S=0;S<1<<P[A];S++)u[j++]=A;for(u[j-1]=A,A=$=0;A<16;A++)for(W[A]=$,S=0;S<1<<Z[A];S++)F[$++]=A;for($>>=7;A<c;A++)for(W[A]=$<<7,S=0;S<1<<Z[A]-7;S++)F[256+$++]=A;for(U=0;U<=g;U++)Y[U]=0;for(S=0;S<=143;)J[2*S+1]=8,S++,Y[8]++;for(;S<=255;)J[2*S+1]=9,S++,Y[9]++;for(;S<=279;)J[2*S+1]=7,S++,Y[7]++;for(;S<=287;)J[2*S+1]=8,S++,Y[8]++;for(ht(J,k+1,Y),S=0;S<c;S++)E[2*S+1]=5,E[2*S]=st(S,5);Q=new D(J,P,y+1,k,g),M=new D(E,Z,0,c,g),tt=new D(new Array(0),O,0,w,v)}(),N=!0),p.l_desc=new z(p.dyn_ltree,Q),p.d_desc=new z(p.dyn_dtree,M),p.bl_desc=new z(p.bl_tree,tt),p.bi_buf=0,p.bi_valid=0,et(p)},a._tr_stored_block=_,a._tr_flush_block=function(p,S,U,j){var A,$,Y=0;0<p.level?(p.strm.data_type===2&&(p.strm.data_type=function(V){var K,it=4093624447;for(K=0;K<=31;K++,it>>>=1)if(1&it&&V.dyn_ltree[2*K]!==0)return l;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return s;for(K=32;K<y;K++)if(V.dyn_ltree[2*K]!==0)return s;return l}(p)),dt(p,p.l_desc),dt(p,p.d_desc),Y=function(V){var K;for(n(V,V.dyn_ltree,V.l_desc.max_code),n(V,V.dyn_dtree,V.d_desc.max_code),dt(V,V.bl_desc),K=w-1;3<=K&&V.bl_tree[2*G[K]+1]===0;K--);return V.opt_len+=3*(K+1)+5+5+4,K}(p),A=p.opt_len+3+7>>>3,($=p.static_len+3+7>>>3)<=A&&(A=$)):A=$=U+5,U+4<=A&&S!==-1?_(p,S,U,j):p.strategy===4||$===A?(X(p,2+(j?1:0),3),pt(p,J,E)):(X(p,4+(j?1:0),3),function(V,K,it,rt){var ct;for(X(V,K-257,5),X(V,it-1,5),X(V,rt-4,4),ct=0;ct<rt;ct++)X(V,V.bl_tree[2*G[ct]+1],3);B(V,V.dyn_ltree,K-1),B(V,V.dyn_dtree,it-1)}(p,p.l_desc.max_code+1,p.d_desc.max_code+1,Y+1),pt(p,p.dyn_ltree,p.dyn_dtree)),et(p),j&&nt(p)},a._tr_tally=function(p,S,U){return p.pending_buf[p.d_buf+2*p.last_lit]=S>>>8&255,p.pending_buf[p.d_buf+2*p.last_lit+1]=255&S,p.pending_buf[p.l_buf+p.last_lit]=255&U,p.last_lit++,S===0?p.dyn_ltree[2*U]++:(p.matches++,S--,p.dyn_ltree[2*(u[U]+y+1)]++,p.dyn_dtree[2*T(S)]++),p.last_lit===p.lit_bufsize-1},a._tr_align=function(p){X(p,2,3),H(p,x,J),function(S){S.bi_valid===16?(q(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)}(p)}},{"../utils/common":41}],53:[function(t,h,a){h.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,h,a){(function(r){(function(l,s){if(!l.setImmediate){var o,m,b,y,k=1,c={},w=!1,f=l.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(l);g=g&&g.setTimeout?g:l,o={}.toString.call(l.process)==="[object process]"?function(I){process.nextTick(function(){v(I)})}:function(){if(l.postMessage&&!l.importScripts){var I=!0,C=l.onmessage;return l.onmessage=function(){I=!1},l.postMessage("","*"),l.onmessage=C,I}}()?(y="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",x,!1):l.attachEvent("onmessage",x),function(I){l.postMessage(y+I,"*")}):l.MessageChannel?((b=new MessageChannel).port1.onmessage=function(I){v(I.data)},function(I){b.port2.postMessage(I)}):f&&"onreadystatechange"in f.createElement("script")?(m=f.documentElement,function(I){var C=f.createElement("script");C.onreadystatechange=function(){v(I),C.onreadystatechange=null,m.removeChild(C),C=null},m.appendChild(C)}):function(I){setTimeout(v,0,I)},g.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var C=new Array(arguments.length-1),L=0;L<C.length;L++)C[L]=arguments[L+1];var P={callback:I,args:C};return c[k]=P,o(k),k++},g.clearImmediate=d}function d(I){delete c[I]}function v(I){if(w)setTimeout(v,0,I);else{var C=c[I];if(C){w=!0;try{(function(L){var P=L.callback,Z=L.args;switch(Z.length){case 0:P();break;case 1:P(Z[0]);break;case 2:P(Z[0],Z[1]);break;case 3:P(Z[0],Z[1],Z[2]);break;default:P.apply(s,Z)}})(C)}finally{d(I),w=!1}}}}function x(I){I.source===l&&typeof I.data=="string"&&I.data.indexOf(y)===0&&v(+I.data.slice(y.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof At<"u"?At:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Gt);var Dt=Gt.exports;const Ht=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Qt=Ht+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",te="["+Ht+"]["+Qt+"]*",ee=new RegExp("^"+te+"$");function Xt(i,e){const t=[];let h=e.exec(i);for(;h;){const a=[];a.startIndex=e.lastIndex-h[0].length;const r=h.length;for(let l=0;l<r;l++)a.push(h[l]);t.push(a),h=e.exec(i)}return t}const Lt=function(i){const e=ee.exec(i);return!(e===null||typeof e>"u")};function re(i){return typeof i<"u"}const ne={allowBooleanAttributes:!1,unpairedTags:[]};function ie(i,e){e=Object.assign({},ne,e);const t=[];let h=!1,a=!1;i[0]==="\uFEFF"&&(i=i.substr(1));for(let r=0;r<i.length;r++)if(i[r]==="<"&&i[r+1]==="?"){if(r+=2,r=Wt(i,r),r.err)return r}else if(i[r]==="<"){let l=r;if(r++,i[r]==="!"){r=$t(i,r);continue}else{let s=!1;i[r]==="/"&&(s=!0,r++);let o="";for(;r<i.length&&i[r]!==">"&&i[r]!==" "&&i[r]!=="	"&&i[r]!==`
`&&i[r]!=="\r";r++)o+=i[r];if(o=o.trim(),o[o.length-1]==="/"&&(o=o.substring(0,o.length-1),r--),!ce(o)){let y;return o.trim().length===0?y="Invalid space after '<'.":y="Tag '"+o+"' is an invalid name.",ut("InvalidTag",y,ft(i,r))}const m=oe(i,r);if(m===!1)return ut("InvalidAttr","Attributes for '"+o+"' have open quote.",ft(i,r));let b=m.value;if(r=m.index,b[b.length-1]==="/"){const y=r-b.length;b=b.substring(0,b.length-1);const k=Vt(b,e);if(k===!0)h=!0;else return ut(k.err.code,k.err.msg,ft(i,y+k.err.line))}else if(s)if(m.tagClosed){if(b.trim().length>0)return ut("InvalidTag","Closing tag '"+o+"' can't have attributes or invalid starting.",ft(i,l));if(t.length===0)return ut("InvalidTag","Closing tag '"+o+"' has not been opened.",ft(i,l));{const y=t.pop();if(o!==y.tagName){let k=ft(i,y.tagStartPos);return ut("InvalidTag","Expected closing tag '"+y.tagName+"' (opened in line "+k.line+", col "+k.col+") instead of closing tag '"+o+"'.",ft(i,l))}t.length==0&&(a=!0)}}else return ut("InvalidTag","Closing tag '"+o+"' doesn't have proper closing.",ft(i,r));else{const y=Vt(b,e);if(y!==!0)return ut(y.err.code,y.err.msg,ft(i,r-b.length+y.err.line));if(a===!0)return ut("InvalidXml","Multiple possible root nodes found.",ft(i,r));e.unpairedTags.indexOf(o)!==-1||t.push({tagName:o,tagStartPos:l}),h=!0}for(r++;r<i.length;r++)if(i[r]==="<")if(i[r+1]==="!"){r++,r=$t(i,r);continue}else if(i[r+1]==="?"){if(r=Wt(i,++r),r.err)return r}else break;else if(i[r]==="&"){const y=he(i,r);if(y==-1)return ut("InvalidChar","char '&' is not expected.",ft(i,r));r=y}else if(a===!0&&!Zt(i[r]))return ut("InvalidXml","Extra text at the end",ft(i,r));i[r]==="<"&&r--}}else{if(Zt(i[r]))continue;return ut("InvalidChar","char '"+i[r]+"' is not expected.",ft(i,r))}if(h){if(t.length==1)return ut("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",ft(i,t[0].tagStartPos));if(t.length>0)return ut("InvalidXml","Invalid '"+JSON.stringify(t.map(r=>r.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return ut("InvalidXml","Start tag expected.",1);return!0}function Zt(i){return i===" "||i==="	"||i===`
`||i==="\r"}function Wt(i,e){const t=e;for(;e<i.length;e++)if(i[e]=="?"||i[e]==" "){const h=i.substr(t,e-t);if(e>5&&h==="xml")return ut("InvalidXml","XML declaration allowed only at the start of the document.",ft(i,e));if(i[e]=="?"&&i[e+1]==">"){e++;break}else continue}return e}function $t(i,e){if(i.length>e+5&&i[e+1]==="-"&&i[e+2]==="-"){for(e+=3;e<i.length;e++)if(i[e]==="-"&&i[e+1]==="-"&&i[e+2]===">"){e+=2;break}}else if(i.length>e+8&&i[e+1]==="D"&&i[e+2]==="O"&&i[e+3]==="C"&&i[e+4]==="T"&&i[e+5]==="Y"&&i[e+6]==="P"&&i[e+7]==="E"){let t=1;for(e+=8;e<i.length;e++)if(i[e]==="<")t++;else if(i[e]===">"&&(t--,t===0))break}else if(i.length>e+9&&i[e+1]==="["&&i[e+2]==="C"&&i[e+3]==="D"&&i[e+4]==="A"&&i[e+5]==="T"&&i[e+6]==="A"&&i[e+7]==="["){for(e+=8;e<i.length;e++)if(i[e]==="]"&&i[e+1]==="]"&&i[e+2]===">"){e+=2;break}}return e}const se='"',ae="'";function oe(i,e){let t="",h="",a=!1;for(;e<i.length;e++){if(i[e]===se||i[e]===ae)h===""?h=i[e]:h!==i[e]||(h="");else if(i[e]===">"&&h===""){a=!0;break}t+=i[e]}return h!==""?!1:{value:t,index:e,tagClosed:a}}const ue=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Vt(i,e){const t=Xt(i,ue),h={};for(let a=0;a<t.length;a++){if(t[a][1].length===0)return ut("InvalidAttr","Attribute '"+t[a][2]+"' has no space in starting.",St(t[a]));if(t[a][3]!==void 0&&t[a][4]===void 0)return ut("InvalidAttr","Attribute '"+t[a][2]+"' is without value.",St(t[a]));if(t[a][3]===void 0&&!e.allowBooleanAttributes)return ut("InvalidAttr","boolean attribute '"+t[a][2]+"' is not allowed.",St(t[a]));const r=t[a][2];if(!fe(r))return ut("InvalidAttr","Attribute '"+r+"' is an invalid name.",St(t[a]));if(!h.hasOwnProperty(r))h[r]=1;else return ut("InvalidAttr","Attribute '"+r+"' is repeated.",St(t[a]))}return!0}function le(i,e){let t=/\d/;for(i[e]==="x"&&(e++,t=/[\da-fA-F]/);e<i.length;e++){if(i[e]===";")return e;if(!i[e].match(t))break}return-1}function he(i,e){if(e++,i[e]===";")return-1;if(i[e]==="#")return e++,le(i,e);let t=0;for(;e<i.length;e++,t++)if(!(i[e].match(/\w/)&&t<20)){if(i[e]===";")break;return-1}return e}function ut(i,e,t){return{err:{code:i,msg:e,line:t.line||t,col:t.col}}}function fe(i){return Lt(i)}function ce(i){return Lt(i)}function ft(i,e){const t=i.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function St(i){return i.startIndex+i[1].length}const de={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(i,e){return e},attributeValueProcessor:function(i,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(i,e,t){return i},captureMetaData:!1},pe=function(i){return Object.assign({},de,i)};let Ot;typeof Symbol!="function"?Ot="@@xmlMetadata":Ot=Symbol("XML Node Metadata");class yt{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,[":@"]:e[":@"]}):this.child.push({[e.tagname]:e.child}),t!==void 0&&(this.child[this.child.length-1][Ot]={startIndex:t})}static getMetaDataSymbol(){return Ot}}function ge(i,e){const t={};if(i[e+3]==="O"&&i[e+4]==="C"&&i[e+5]==="T"&&i[e+6]==="Y"&&i[e+7]==="P"&&i[e+8]==="E"){e=e+9;let h=1,a=!1,r=!1,l="";for(;e<i.length;e++)if(i[e]==="<"&&!r){if(a&&wt(i,"!ENTITY",e)){e+=7;let s,o;[s,o,e]=me(i,e+1),o.indexOf("&")===-1&&(t[s]={regx:RegExp(`&${s};`,"g"),val:o})}else if(a&&wt(i,"!ELEMENT",e)){e+=8;const{index:s}=be(i,e+1);e=s}else if(a&&wt(i,"!ATTLIST",e))e+=8;else if(a&&wt(i,"!NOTATION",e)){e+=9;const{index:s}=_e(i,e+1);e=s}else if(wt(i,"!--",e))r=!0;else throw new Error("Invalid DOCTYPE");h++,l=""}else if(i[e]===">"){if(r?i[e-1]==="-"&&i[e-2]==="-"&&(r=!1,h--):h--,h===0)break}else i[e]==="["?a=!0:l+=i[e];if(h!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}const _t=(i,e)=>{for(;e<i.length&&/\s/.test(i[e]);)e++;return e};function me(i,e){e=_t(i,e);let t="";for(;e<i.length&&!/\s/.test(i[e])&&i[e]!=='"'&&i[e]!=="'";)t+=i[e],e++;if(Ut(t),e=_t(i,e),i.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(i[e]==="%")throw new Error("Parameter entities are not supported");let h="";return[e,h]=Nt(i,e,"entity"),e--,[t,h,e]}function _e(i,e){e=_t(i,e);let t="";for(;e<i.length&&!/\s/.test(i[e]);)t+=i[e],e++;Ut(t),e=_t(i,e);const h=i.substring(e,e+6).toUpperCase();if(h!=="SYSTEM"&&h!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${h}"`);e+=h.length,e=_t(i,e);let a=null,r=null;if(h==="PUBLIC")[e,a]=Nt(i,e,"publicIdentifier"),e=_t(i,e),(i[e]==='"'||i[e]==="'")&&([e,r]=Nt(i,e,"systemIdentifier"));else if(h==="SYSTEM"&&([e,r]=Nt(i,e,"systemIdentifier"),!r))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:t,publicIdentifier:a,systemIdentifier:r,index:--e}}function Nt(i,e,t){let h="";const a=i[e];if(a!=='"'&&a!=="'")throw new Error(`Expected quoted string, found "${a}"`);for(e++;e<i.length&&i[e]!==a;)h+=i[e],e++;if(i[e]!==a)throw new Error(`Unterminated ${t} value`);return e++,[e,h]}function be(i,e){e=_t(i,e);let t="";for(;e<i.length&&!/\s/.test(i[e]);)t+=i[e],e++;if(!Ut(t))throw new Error(`Invalid element name: "${t}"`);e=_t(i,e);let h="";if(i[e]==="E"&&wt(i,"MPTY",e))e+=4;else if(i[e]==="A"&&wt(i,"NY",e))e+=2;else if(i[e]==="("){for(e++;e<i.length&&i[e]!==")";)h+=i[e],e++;if(i[e]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${i[e]}"`);return{elementName:t,contentModel:h.trim(),index:e}}function wt(i,e,t){for(let h=0;h<e.length;h++)if(e[h]!==i[t+h+1])return!1;return!0}function Ut(i){if(Lt(i))return i;throw new Error(`Invalid entity name ${i}`)}const ye=/^[-+]?0x[a-fA-F0-9]+$/,we=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,ve={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function ke(i,e={}){if(e=Object.assign({},ve,e),!i||typeof i!="string")return i;let t=i.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return i;if(i==="0")return 0;if(e.hex&&ye.test(t))return Ce(t,16);if(t.search(/.+[eE].+/)!==-1)return xe(i,t,e);{const h=we.exec(t);if(h){const a=h[1]||"",r=h[2];let l=Se(h[3]);const s=a?i[r.length+1]===".":i[r.length]===".";if(!e.leadingZeros&&(r.length>1||r.length===1&&!s))return i;{const o=Number(t),m=String(o);if(o===0)return o;if(m.search(/[eE]/)!==-1)return e.eNotation?o:i;if(t.indexOf(".")!==-1)return m==="0"||m===l||m===`${a}${l}`?o:i;let b=r?l:t;return r?b===m||a+b===m?o:i:b===m||b===a+m?o:i}}else return i}}const Ee=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function xe(i,e,t){if(!t.eNotation)return i;const h=e.match(Ee);if(h){let a=h[1]||"";const r=h[3].indexOf("e")===-1?"E":"e",l=h[2],s=a?i[l.length+1]===r:i[l.length]===r;return l.length>1&&s?i:l.length===1&&(h[3].startsWith(`.${r}`)||h[3][0]===r)?Number(e):t.leadingZeros&&!s?(e=(h[1]||"")+h[3],Number(e)):i}else return i}function Se(i){return i&&i.indexOf(".")!==-1&&(i=i.replace(/0+$/,""),i==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substring(0,i.length-1))),i}function Ce(i,e){if(parseInt)return parseInt(i,e);if(Number.parseInt)return Number.parseInt(i,e);if(window&&window.parseInt)return window.parseInt(i,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function Ie(i){return typeof i=="function"?i:Array.isArray(i)?e=>{for(const t of i)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}class Ae{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,h)=>String.fromCodePoint(Number.parseInt(h,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,h)=>String.fromCodePoint(Number.parseInt(h,16))}},this.addExternalEntities=Te,this.parseXml=Fe,this.parseTextData=ze,this.resolveNameSpace=Ne,this.buildAttributesMap=Pe,this.isItStopNode=Ue,this.replaceEntitiesValue=Re,this.readStopNodeData=Me,this.saveTextToParentTag=Le,this.addChild=Be,this.ignoreAttributesFn=Ie(this.options.ignoreAttributes)}}function Te(i){const e=Object.keys(i);for(let t=0;t<e.length;t++){const h=e[t];this.lastEntities[h]={regex:new RegExp("&"+h+";","g"),val:i[h]}}}function ze(i,e,t,h,a,r,l){if(i!==void 0&&(this.options.trimValues&&!h&&(i=i.trim()),i.length>0)){l||(i=this.replaceEntitiesValue(i));const s=this.options.tagValueProcessor(e,i,t,a,r);return s==null?i:typeof s!=typeof i||s!==i?s:this.options.trimValues?Rt(i,this.options.parseTagValue,this.options.numberParseOptions):i.trim()===i?Rt(i,this.options.parseTagValue,this.options.numberParseOptions):i}}function Ne(i){if(this.options.removeNSPrefix){const e=i.split(":"),t=i.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(i=t+e[1])}return i}const Oe=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Pe(i,e,t){if(this.options.ignoreAttributes!==!0&&typeof i=="string"){const h=Xt(i,Oe),a=h.length,r={};for(let l=0;l<a;l++){const s=this.resolveNameSpace(h[l][1]);if(this.ignoreAttributesFn(s,e))continue;let o=h[l][4],m=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(m=this.options.transformAttributeName(m)),m==="__proto__"&&(m="#__proto__"),o!==void 0){this.options.trimValues&&(o=o.trim()),o=this.replaceEntitiesValue(o);const b=this.options.attributeValueProcessor(s,o,e);b==null?r[m]=o:typeof b!=typeof o||b!==o?r[m]=b:r[m]=Rt(o,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(r[m]=!0)}if(!Object.keys(r).length)return;if(this.options.attributesGroupName){const l={};return l[this.options.attributesGroupName]=r,l}return r}}const Fe=function(i){i=i.replace(/\r\n?/g,`
`);const e=new yt("!xml");let t=e,h="",a="";for(let r=0;r<i.length;r++)if(i[r]==="<")if(i[r+1]==="/"){const s=vt(i,">",r,"Closing Tag is not closed.");let o=i.substring(r+2,s).trim();if(this.options.removeNSPrefix){const y=o.indexOf(":");y!==-1&&(o=o.substr(y+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),t&&(h=this.saveTextToParentTag(h,t,a));const m=a.substring(a.lastIndexOf(".")+1);if(o&&this.options.unpairedTags.indexOf(o)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${o}>`);let b=0;m&&this.options.unpairedTags.indexOf(m)!==-1?(b=a.lastIndexOf(".",a.lastIndexOf(".")-1),this.tagsNodeStack.pop()):b=a.lastIndexOf("."),a=a.substring(0,b),t=this.tagsNodeStack.pop(),h="",r=s}else if(i[r+1]==="?"){let s=Bt(i,r,!1,"?>");if(!s)throw new Error("Pi Tag is not closed.");if(h=this.saveTextToParentTag(h,t,a),!(this.options.ignoreDeclaration&&s.tagName==="?xml"||this.options.ignorePiTags)){const o=new yt(s.tagName);o.add(this.options.textNodeName,""),s.tagName!==s.tagExp&&s.attrExpPresent&&(o[":@"]=this.buildAttributesMap(s.tagExp,a,s.tagName)),this.addChild(t,o,a,r)}r=s.closeIndex+1}else if(i.substr(r+1,3)==="!--"){const s=vt(i,"-->",r+4,"Comment is not closed.");if(this.options.commentPropName){const o=i.substring(r+4,s-2);h=this.saveTextToParentTag(h,t,a),t.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}r=s}else if(i.substr(r+1,2)==="!D"){const s=ge(i,r);this.docTypeEntities=s.entities,r=s.i}else if(i.substr(r+1,2)==="!["){const s=vt(i,"]]>",r,"CDATA is not closed.")-2,o=i.substring(r+9,s);h=this.saveTextToParentTag(h,t,a);let m=this.parseTextData(o,t.tagname,a,!0,!1,!0,!0);m==null&&(m=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]):t.add(this.options.textNodeName,m),r=s+2}else{let s=Bt(i,r,this.options.removeNSPrefix),o=s.tagName;const m=s.rawTagName;let b=s.tagExp,y=s.attrExpPresent,k=s.closeIndex;this.options.transformTagName&&(o=this.options.transformTagName(o)),t&&h&&t.tagname!=="!xml"&&(h=this.saveTextToParentTag(h,t,a,!1));const c=t;c&&this.options.unpairedTags.indexOf(c.tagname)!==-1&&(t=this.tagsNodeStack.pop(),a=a.substring(0,a.lastIndexOf("."))),o!==e.tagname&&(a+=a?"."+o:o);const w=r;if(this.isItStopNode(this.options.stopNodes,a,o)){let f="";if(b.length>0&&b.lastIndexOf("/")===b.length-1)o[o.length-1]==="/"?(o=o.substr(0,o.length-1),a=a.substr(0,a.length-1),b=o):b=b.substr(0,b.length-1),r=s.closeIndex;else if(this.options.unpairedTags.indexOf(o)!==-1)r=s.closeIndex;else{const d=this.readStopNodeData(i,m,k+1);if(!d)throw new Error(`Unexpected end of ${m}`);r=d.i,f=d.tagContent}const g=new yt(o);o!==b&&y&&(g[":@"]=this.buildAttributesMap(b,a,o)),f&&(f=this.parseTextData(f,o,a,!0,y,!0,!0)),a=a.substr(0,a.lastIndexOf(".")),g.add(this.options.textNodeName,f),this.addChild(t,g,a,w)}else{if(b.length>0&&b.lastIndexOf("/")===b.length-1){o[o.length-1]==="/"?(o=o.substr(0,o.length-1),a=a.substr(0,a.length-1),b=o):b=b.substr(0,b.length-1),this.options.transformTagName&&(o=this.options.transformTagName(o));const f=new yt(o);o!==b&&y&&(f[":@"]=this.buildAttributesMap(b,a,o)),this.addChild(t,f,a,w),a=a.substr(0,a.lastIndexOf("."))}else{const f=new yt(o);this.tagsNodeStack.push(t),o!==b&&y&&(f[":@"]=this.buildAttributesMap(b,a,o)),this.addChild(t,f,a,w),t=f}h="",r=k}}else h+=i[r];return e.child};function Be(i,e,t,h){this.options.captureMetaData||(h=void 0);const a=this.options.updateTag(e.tagname,t,e[":@"]);a===!1||(typeof a=="string"&&(e.tagname=a),i.addChild(e,h))}const Re=function(i){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];i=i.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];i=i.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];i=i.replace(t.regex,t.val)}i=i.replace(this.ampEntity.regex,this.ampEntity.val)}return i};function Le(i,e,t,h){return i&&(h===void 0&&(h=e.child.length===0),i=this.parseTextData(i,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,h),i!==void 0&&i!==""&&e.add(this.options.textNodeName,i),i=""),i}function Ue(i,e,t){const h="*."+t;for(const a in i){const r=i[a];if(h===r||e===r)return!0}return!1}function je(i,e,t=">"){let h,a="";for(let r=e;r<i.length;r++){let l=i[r];if(h)l===h&&(h="");else if(l==='"'||l==="'")h=l;else if(l===t[0])if(t[1]){if(i[r+1]===t[1])return{data:a,index:r}}else return{data:a,index:r};else l==="	"&&(l=" ");a+=l}}function vt(i,e,t,h){const a=i.indexOf(e,t);if(a===-1)throw new Error(h);return a+e.length-1}function Bt(i,e,t,h=">"){const a=je(i,e+1,h);if(!a)return;let r=a.data;const l=a.index,s=r.search(/\s/);let o=r,m=!0;s!==-1&&(o=r.substring(0,s),r=r.substring(s+1).trimStart());const b=o;if(t){const y=o.indexOf(":");y!==-1&&(o=o.substr(y+1),m=o!==a.data.substr(y+1))}return{tagName:o,tagExp:r,closeIndex:l,attrExpPresent:m,rawTagName:b}}function Me(i,e,t){const h=t;let a=1;for(;t<i.length;t++)if(i[t]==="<")if(i[t+1]==="/"){const r=vt(i,">",t,`${e} is not closed`);if(i.substring(t+2,r).trim()===e&&(a--,a===0))return{tagContent:i.substring(h,t),i:r};t=r}else if(i[t+1]==="?")t=vt(i,"?>",t+1,"StopNode is not closed.");else if(i.substr(t+1,3)==="!--")t=vt(i,"-->",t+3,"StopNode is not closed.");else if(i.substr(t+1,2)==="![")t=vt(i,"]]>",t,"StopNode is not closed.")-2;else{const r=Bt(i,t,">");r&&((r&&r.tagName)===e&&r.tagExp[r.tagExp.length-1]!=="/"&&a++,t=r.closeIndex)}}function Rt(i,e,t){if(e&&typeof i=="string"){const h=i.trim();return h==="true"?!0:h==="false"?!1:ke(i,t)}else return re(i)?i:""}const Ft=yt.getMetaDataSymbol();function Ze(i,e){return Yt(i,e)}function Yt(i,e,t){let h;const a={};for(let r=0;r<i.length;r++){const l=i[r],s=We(l);let o="";if(t===void 0?o=s:o=t+"."+s,s===e.textNodeName)h===void 0?h=l[s]:h+=""+l[s];else{if(s===void 0)continue;if(l[s]){let m=Yt(l[s],e,o);const b=Ve(m,e);l[Ft]!==void 0&&(m[Ft]=l[Ft]),l[":@"]?$e(m,l[":@"],o,e):Object.keys(m).length===1&&m[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?m=m[e.textNodeName]:Object.keys(m).length===0&&(e.alwaysCreateTextNode?m[e.textNodeName]="":m=""),a[s]!==void 0&&a.hasOwnProperty(s)?(Array.isArray(a[s])||(a[s]=[a[s]]),a[s].push(m)):e.isArray(s,o,b)?a[s]=[m]:a[s]=m}}}return typeof h=="string"?h.length>0&&(a[e.textNodeName]=h):h!==void 0&&(a[e.textNodeName]=h),a}function We(i){const e=Object.keys(i);for(let t=0;t<e.length;t++){const h=e[t];if(h!==":@")return h}}function $e(i,e,t,h){if(e){const a=Object.keys(e),r=a.length;for(let l=0;l<r;l++){const s=a[l];h.isArray(s,t+"."+s,!0,!0)?i[s]=[e[s]]:i[s]=e[s]}}}function Ve(i,e){const{textNodeName:t}=e,h=Object.keys(i).length;return!!(h===0||h===1&&(i[t]||typeof i[t]=="boolean"||i[t]===0))}class Ge{constructor(e){this.externalEntities={},this.options=pe(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const r=ie(e,t);if(r!==!0)throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}const h=new Ae(this.options);h.addExternalEntities(this.externalEntities);const a=h.parseXml(e);return this.options.preserveOrder||a===void 0?a:Ze(a,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return yt.getMetaDataSymbol()}}class zt{static parsePresentation(e){const t=e.presentation||{},h=t.sldIdLst||{},a=t.sldMasterIdLst||{},r=t.themeIdLst||{},l=t.sldSz||{};return{slideCount:Array.isArray(h.sldId)?h.sldId.length:0,masterCount:Array.isArray(a.sldMasterId)?a.sldMasterId.length:0,themeCount:Array.isArray(r.themeId)?r.themeId.length:0,slideSize:{width:parseInt(l["@attributes"]?.cx||"9144000"),height:parseInt(l["@attributes"]?.cy||"6858000")}}}static parseSlide(e,t){const h=e["p:sld"]||e.sld||{},a=h["p:spTree"]||h.spTree||{},r=a["p:sp"]||a.sp||[];return{id:`slide-${t}`,name:`Slide ${t}`,number:t,elements:this.parseShapes(r),background:this.parseBackground(h),layout:this.parseLayout(h)}}static parseMasterSlide(e,t){const h=e["p:sldMaster"]||e.sldMaster||{},a=h["p:spTree"]||h.spTree||{},r=a["p:sp"]||a.sp||[];return{id:`master-${t}`,name:`Master ${t}`,number:t,elements:this.parseShapes(r),layouts:this.parseLayouts(h)}}static parseTheme(e,t){const h=e["a:theme"]||e.theme||{},a=h["a:themeElements"]||h.themeElements||{};return{id:`theme-${t}`,name:`Theme ${t}`,number:t,colors:this.parseColorScheme(a),fonts:this.parseFontScheme(a)}}static parseShapes(e){return Array.isArray(e)?e.map((t,h)=>({id:`shape-${h}`,type:this.getShapeType(t),position:this.parsePosition(t),size:this.parseSize(t),text:this.parseText(t),style:this.parseStyle(t)})):[]}static parseBackground(e){const t=e["p:bg"]||e.bg||{},h=t["p:bgPr"]||t.bgPr||{};return{type:h["a:solidFill"]?"solid":"none",color:this.parseColor(h["a:solidFill"]||h.solidFill)}}static parseLayout(e){const t=e["p:sldLayoutId"]||e.sldLayoutId||{};return{id:t["@attributes"]?.id||"default",name:t["@attributes"]?.name||"Default Layout"}}static parseLayouts(e){const t=e["p:sldLayoutIdLst"]||e.sldLayoutIdLst||{},h=t["p:sldLayoutId"]||t.sldLayoutId||[];return Array.isArray(h)?h.map((a,r)=>({id:a["@attributes"]?.id||`layout-${r}`,name:a["@attributes"]?.name||`Layout ${r+1}`,number:r+1})):[]}static parseColorScheme(e){const t=e["a:clrScheme"]||e.clrScheme||{};return{primary:this.parseColor(t["a:dk1"]||t.dk1),secondary:this.parseColor(t["a:dk2"]||t.dk2),accent1:this.parseColor(t["a:accent1"]||t.accent1),accent2:this.parseColor(t["a:accent2"]||t.accent2),accent3:this.parseColor(t["a:accent3"]||t.accent3),accent4:this.parseColor(t["a:accent4"]||t.accent4),accent5:this.parseColor(t["a:accent5"]||t.accent5),accent6:this.parseColor(t["a:accent6"]||t.accent6),hlink:this.parseColor(t["a:hlink"]||t.hlink),folHlink:this.parseColor(t["a:folHlink"]||t.folHlink)}}static parseFontScheme(e){const t=e["a:fontScheme"]||e.fontScheme||{},h=t["a:majorFont"]||t.majorFont||{},a=t["a:minorFont"]||t.minorFont||{};return{major:{name:h["a:latin"]?.["@attributes"]?.typeface||"Arial",script:h["a:ea"]?.["@attributes"]?.typeface||"Arial",complex:h["a:cs"]?.["@attributes"]?.typeface||"Arial"},minor:{name:a["a:latin"]?.["@attributes"]?.typeface||"Arial",script:a["a:ea"]?.["@attributes"]?.typeface||"Arial",complex:a["a:cs"]?.["@attributes"]?.typeface||"Arial"}}}static getShapeType(e){const t=e["p:spPr"]||e.spPr||{};return(t["a:prstGeom"]||t.prstGeom||{})["@attributes"]?.prst||"rectangle"}static parsePosition(e){const t=e["p:spPr"]||e.spPr||{},h=t["a:xfrm"]||t.xfrm||{},a=h["a:off"]||h.off||{};return{x:parseInt(a["@attributes"]?.x||"0"),y:parseInt(a["@attributes"]?.y||"0")}}static parseSize(e){const t=e["p:spPr"]||e.spPr||{},h=t["a:xfrm"]||t.xfrm||{},a=h["a:ext"]||h.ext||{};return{width:parseInt(a["@attributes"]?.cx||"0"),height:parseInt(a["@attributes"]?.cy||"0")}}static parseText(e){const t=e["p:txBody"]||e.txBody||{},h=t["a:bodyPr"]||t.bodyPr||{},a=t["a:p"]||t.p||[];return Array.isArray(a)?{paragraphs:a.map((r,l)=>({id:`p-${l}`,runs:this.parseRuns(r),alignment:h["@attributes"]?.anchor||"t",margins:this.parseMargins(h)}))}:null}static parseRuns(e){const t=e["a:r"]||e.r||[];return Array.isArray(t)?t.map((h,a)=>({id:`run-${a}`,text:h["a:t"]||h.t||"",style:this.parseRunStyle(h)})):[]}static parseRunStyle(e){const t=e["a:rPr"]||e.rPr||{};return{font:t["@attributes"]?.typeface||"Arial",size:parseInt(t["@attributes"]?.sz||"1800"),bold:t["a:b"]!==void 0,italic:t["a:i"]!==void 0,color:this.parseColor(t["a:solidFill"]||t.solidFill)}}static parseStyle(e){const t=e["p:spPr"]||e.spPr||{};return{fill:this.parseFill(t),stroke:this.parseStroke(t),effects:this.parseEffects(t)}}static parseFill(e){const t=e["a:solidFill"]||e.solidFill,h=e["a:gradFill"]||e.gradFill;return t?{type:"solid",color:this.parseColor(t)}:h?{type:"gradient",stops:this.parseGradientStops(h)}:{type:"none"}}static parseStroke(e){const t=e["a:ln"]||e.ln;return t?{type:"solid",width:parseInt(t["@attributes"]?.w||"0"),color:this.parseColor(t["a:solidFill"]||t.solidFill),cap:t["@attributes"]?.cap||"rnd",join:t["@attributes"]?.join||"rnd"}:{type:"none"}}static parseEffects(e){const t=e["a:effectLst"]||e.effectLst;return t?{shadow:this.parseShadow(t["a:outerShdw"]||t.outerShdw),glow:this.parseGlow(t["a:glow"]||t.glow),reflection:this.parseReflection(t["a:reflection"]||t.reflection)}:{}}static parseColor(e){if(!e)return null;if(e["a:srgbClr"]||e.srgbClr){const t=e["a:srgbClr"]||e.srgbClr;return{type:"srgb",value:t["@attributes"]?.val||"000000"}}if(e["a:schemeClr"]||e.schemeClr){const t=e["a:schemeClr"]||e.schemeClr;return{type:"scheme",value:t["@attributes"]?.val||"accent1"}}return null}static parseGradientStops(e){const t=e["a:gsLst"]||e.gsLst||{},h=t["a:gs"]||t.gs||[];return Array.isArray(h)?h.map((a,r)=>({position:parseInt(a["@attributes"]?.pos||"0"),color:this.parseColor(a["a:solidFill"]||a.solidFill)})):[]}static parseMargins(e){return{left:parseInt(e["@attributes"]?.lIns||"0"),top:parseInt(e["@attributes"]?.tIns||"0"),right:parseInt(e["@attributes"]?.rIns||"0"),bottom:parseInt(e["@attributes"]?.bIns||"0")}}static parseShadow(e){return e?{color:this.parseColor(e["a:solidFill"]||e.solidFill),blur:parseInt(e["@attributes"]?.blurRad||"0"),distance:parseInt(e["@attributes"]?.dist||"0"),direction:parseInt(e["@attributes"]?.dir||"0")}:null}static parseGlow(e){return e?{color:this.parseColor(e["a:solidFill"]||e.solidFill),radius:parseInt(e["@attributes"]?.rad||"0")}:null}static parseReflection(e){return e?{alpha:parseInt(e["@attributes"]?.alpha||"0"),distance:parseInt(e["@attributes"]?.dist||"0"),blur:parseInt(e["@attributes"]?.blurRad||"0")}:null}}typeof setImmediate>"u"&&(globalThis.setImmediate=(i,...e)=>setTimeout(()=>i(...e),0));class He{zip=null;xmlParser;onProgress;constructor(e){this.onProgress=e,this.xmlParser=new Ge({ignoreAttributes:!1,attributeNamePrefix:"@",textNodeName:"#text",parseAttributeValue:!1,parseTagValue:!1,trimValues:!0})}async parsePPTX(e,t){const h=Date.now();try{console.log("PPTXAdapter: Starting parsing for",t),this.updateProgress({stage:"initializing",progress:0,message:"\u0418\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u043F\u0430\u0440\u0441\u0435\u0440\u0430..."}),await this.loadZipArchive(e);const a=await this.parsePresentationFile(),r=await this.parseSlideFiles(),l=await this.parseMasterSlideFiles(),s=await this.parseThemeFiles(),o=await this.parseMediaFiles(),m={fileName:t,fileSize:e.byteLength,slides:r,masters:l,themes:s,media:o,presentation:a},b=Date.now()-h;return console.log("PPTXAdapter: Parsing completed successfully",{result:m,processingTime:b}),this.updateProgress({stage:"completed",progress:100,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D"}),{success:!0,data:m,errors:[],warnings:[],processingTime:b}}catch(a){const r=Date.now()-h,l=a instanceof Error?a.message:"Unknown error";return console.error("PPTXAdapter: Parsing error",a),this.updateProgress({stage:"error",progress:0,message:`\u041E\u0448\u0438\u0431\u043A\u0430: ${l}`}),{success:!1,errors:[l],warnings:[],processingTime:r}}}async loadZipArchive(e){this.updateProgress({stage:"loading",progress:10,message:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ZIP \u0430\u0440\u0445\u0438\u0432\u0430..."}),this.zip=new Dt,await this.zip.loadAsync(e)}async parsePresentationFile(){this.updateProgress({stage:"parsing",progress:20,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 presentation.xml..."});const e=this.zip?.file("ppt/presentation.xml");if(!e)throw new Error("presentation.xml not found");const t=await e.async("string"),h=this.xmlParser.parse(t);return zt.parsePresentation(h)}async parseSlideFiles(){this.updateProgress({stage:"parsing",progress:30,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u0441\u043B\u0430\u0439\u0434\u043E\u0432..."});const e=[],t=this.getSlideFiles();for(let h=0;h<t.length;h++){const a=t[h],r=h+1;this.updateProgress({stage:"parsing",progress:30+h/t.length*20,message:`\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u0441\u043B\u0430\u0439\u0434\u0430 ${r}/${t.length}...`});try{const l=await a.async("string"),s=this.xmlParser.parse(l),o=zt.parseSlide(s,r);e.push(o)}catch(l){console.warn(`Error parsing slide ${r}:`,l)}}return e}async parseMasterSlideFiles(){this.updateProgress({stage:"parsing",progress:50,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u043C\u0430\u0441\u0442\u0435\u0440-\u0441\u043B\u0430\u0439\u0434\u043E\u0432..."});const e=[],t=this.getMasterSlideFiles();for(let h=0;h<t.length;h++){const a=t[h],r=h+1;try{const l=await a.async("string"),s=this.xmlParser.parse(l),o=zt.parseMasterSlide(s,r);e.push(o)}catch(l){console.warn(`Error parsing master slide ${r}:`,l)}}return e}async parseThemeFiles(){this.updateProgress({stage:"parsing",progress:60,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u0442\u0435\u043C..."});const e=[],t=this.getThemeFiles();for(let h=0;h<t.length;h++){const a=t[h],r=h+1;try{const l=await a.async("string"),s=this.xmlParser.parse(l),o=zt.parseTheme(s,r);e.push(o)}catch(l){console.warn(`Error parsing theme ${r}:`,l)}}return e}async parseMediaFiles(){this.updateProgress({stage:"parsing",progress:70,message:"\u041F\u0430\u0440\u0441\u0438\u043D\u0433 \u043C\u0435\u0434\u0438\u0430 \u0444\u0430\u0439\u043B\u043E\u0432..."});const e=[],t=this.getMediaFiles();for(const h of t)try{const a=await h.async("uint8array"),r={id:`media-${e.length}`,name:h.name.split("/").pop()||"unknown",type:this.getMediaType(h.name),src:h.name,size:a.length,data:a,mimeType:this.getMimeType(h.name)};e.push(r)}catch(a){console.warn(`Error parsing media file ${h.name}:`,a)}return e}getSlideFiles(){return this.zip?Object.values(this.zip.files).filter(e=>e.name.startsWith("ppt/slides/slide")&&e.name.endsWith(".xml")).sort((e,t)=>{const h=parseInt(e.name.match(/slide(\d+)/)?.[1]||"0"),a=parseInt(t.name.match(/slide(\d+)/)?.[1]||"0");return h-a}):[]}getMasterSlideFiles(){return this.zip?Object.values(this.zip.files).filter(e=>e.name.startsWith("ppt/slideMasters/slideMaster")&&e.name.endsWith(".xml")).sort((e,t)=>{const h=parseInt(e.name.match(/slideMaster(\d+)/)?.[1]||"0"),a=parseInt(t.name.match(/slideMaster(\d+)/)?.[1]||"0");return h-a}):[]}getThemeFiles(){return this.zip?Object.values(this.zip.files).filter(e=>e.name.startsWith("ppt/theme/theme")&&e.name.endsWith(".xml")).sort((e,t)=>{const h=parseInt(e.name.match(/theme(\d+)/)?.[1]||"0"),a=parseInt(t.name.match(/theme(\d+)/)?.[1]||"0");return h-a}):[]}getMediaFiles(){return this.zip?Object.values(this.zip.files).filter(e=>e.name.startsWith("ppt/media/")&&!e.dir):[]}getMediaType(e){const t=e.split(".").pop()?.toLowerCase();return["jpg","jpeg","png","gif","bmp","svg"].includes(t||"")?"image":["mp4","avi","mov","wmv"].includes(t||"")?"video":"audio"}getMimeType(e){const t=e.split(".").pop()?.toLowerCase();return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",svg:"image/svg+xml",mp4:"video/mp4",avi:"video/x-msvideo",mov:"video/quicktime",wmv:"video/x-ms-wmv"}[t||""]||"application/octet-stream"}updateProgress(e){this.onProgress?.(e)}}const bt=self;bt.addEventListener("error",i=>{console.error("Worker internal error:",i),bt.postMessage({type:"error",payload:{error:`Worker internal error: ${i.message||"Unknown error"}`}})});bt.addEventListener("message",async i=>{try{const{type:e,payload:t}=i.data;switch(console.log("Worker received message:",e,t),e){case"parse-pptx":await Xe(t);break;case"cancel":break;default:bt.postMessage({type:"error",payload:{error:`Unknown message type: ${e}`}})}}catch(e){console.error("Worker error handling message:",e),bt.postMessage({type:"error",payload:{error:`Worker error: ${e.message}`}})}});async function Xe(i){try{const{fileData:e,fileName:t}=i;console.log("Starting PPTX parsing for:",t,"Size:",e.byteLength);const a=await new He(r=>{console.log("Parsing progress:",r),bt.postMessage({type:"progress",payload:r})}).parsePPTX(e,t);console.log("Parsing completed:",a),bt.postMessage({type:"complete",payload:a})}catch(e){console.error("PPTX parsing error:",e);const t=e instanceof Error?e.message:"Unknown error";bt.postMessage({type:"error",payload:{error:t}})}}
